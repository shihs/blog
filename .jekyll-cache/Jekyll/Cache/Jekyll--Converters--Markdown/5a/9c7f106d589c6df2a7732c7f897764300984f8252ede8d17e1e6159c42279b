I"D<h2 id="flask-ç°¡ä»‹">Flask ç°¡ä»‹</h2>

<p><a href="https://flask.palletsprojects.com/en/2.0.x/">Flask</a>. A web framework takes care of all the routing needed to organize a web page so that you donâ€™t have to write the code yourself!</p>

<p><strong>Why Flask?</strong></p>

<ul>
  <li>First and foremost, youâ€™ll be working with Flask because it is written in Python. You wonâ€™t need to learn a new programming language.</li>
  <li>Flask is also a relatively simple framework, so itâ€™s good for making a small web app.</li>
  <li>Because Flask is written in Python, you can use Flask with any other Python library including pandas, numpy and scikit-learn. In this lesson, youâ€™ll be deploying a data dashboard and pandas will help get the data ready.</li>
</ul>

<hr />

<h2 id="åŸºæœ¬æ¨£æ¿">åŸºæœ¬æ¨£æ¿</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># æª”æ¡ˆçµæ§‹
|- webapp.py
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># webapp.py
</span><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span> <span class="c1"># __name__ ä»£è¡¨ç›®å‰åŸ·è¡Œçš„æ¨¡çµ„
</span>
<span class="o">@</span><span class="n">app</span><span class="p">.</span><span class="n">route</span><span class="p">(</span><span class="s">'/'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="k">return</span> <span class="s">'Index page'</span>


<span class="o">@</span><span class="n">app</span><span class="p">.</span><span class="n">route</span><span class="p">(</span><span class="s">'/hello'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">hello</span><span class="p">():</span>
    <span class="k">return</span> <span class="s">'Hello World!'</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
     <span class="n">app</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
     <span class="c1"># app.run(host='127.0.0.1', port=8000)
</span></code></pre></div></div>
<p><img src="https://i.imgur.com/Fmq8bFT.png" alt="" /></p>

<p>åœ¨é–‹ç™¼çš„æ™‚å€™åŠ ä¸Š <code class="language-plaintext highlighter-rouge">app.run(debug=True)</code> è®“ç¨‹å¼èª¿æ•´çš„æ™‚å€™ä¸éœ€è¦æ¯æ¬¡é‡å•Ÿï¼Œæ‰€ä»¥åœ¨æ­£å¼ç’°å¢ƒæ™‚ä¸æœƒè¨­ç½®ã€‚ä¹Ÿå¯ä»¥å¯«æˆï¼Œ<code class="language-plaintext highlighter-rouge">app.debug=True</code>ã€<code class="language-plaintext highlighter-rouge">app.run()</code>ã€‚</p>

<hr />

<h3 id="approute">@app.route()</h3>

<p>ä»‹ç´¹<code class="language-plaintext highlighter-rouge">@app.route()</code>å‰å…ˆäº†è§£ Python çš„è£é£¾å™¨ï¼ˆDecoratorï¼‰<code class="language-plaintext highlighter-rouge">@</code>ã€‚</p>

<p><strong>Python çš„ Decorator</strong></p>

<ul>
  <li>æ–‡ç« ï¼š<a href="https://medium.com/citycoddee/python%E9%80%B2%E9%9A%8E%E6%8A%80%E5%B7%A7-3-%E7%A5%9E%E5%A5%87%E5%8F%88%E7%BE%8E%E5%A5%BD%E7%9A%84-decorator-%E5%97%B7%E5%97%9A-6559edc87bc0">Pythoné€²éšæŠ€å·§ (3) â€” ç¥å¥‡åˆç¾å¥½çš„ Decorator ï¼Œå—·å—šï¼</a></li>
  <li>general decorators tutorial: <a href="https://realpython.com/primer-on-python-decorators/">Primer on Python Decorators</a></li>
  <li>In Python, the @ symbol is used for decorators.</li>
  <li>A decorator is just a function which takes in a function (the one which you decorated with the â€œ@â€ symbol) and returns a new function.</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># This is our decorator
</span><span class="k">def</span> <span class="nf">simple_decorator</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
    <span class="c1"># This is the new function we're going to return
</span>    <span class="c1"># This function will be used in place of our original definition
</span>    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">():</span>
        <span class="k">print</span> <span class="s">"Entering Function"</span>
        <span class="n">f</span><span class="p">()</span>
        <span class="k">print</span> <span class="s">"Exited Function"</span>

    <span class="k">return</span> <span class="n">wrapper</span>

<span class="o">@</span><span class="n">simple_decorator</span> 
<span class="k">def</span> <span class="nf">hello</span><span class="p">():</span>
    <span class="k">print</span> <span class="s">"Hello World"</span>

<span class="n">hello</span><span class="p">()</span>
</code></pre></div></div>

<p>çµæœï¼š</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Entering Function
Hello World
Exited Function
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">decorator_factory</span><span class="p">(</span><span class="n">enter_message</span><span class="p">,</span> <span class="n">exit_message</span><span class="p">):</span>
    <span class="c1"># We're going to return this decorator
</span>    <span class="k">def</span> <span class="nf">simple_decorator</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">wrapper</span><span class="p">():</span>
            <span class="k">print</span> <span class="n">enter_message</span>
            <span class="n">f</span><span class="p">()</span>
            <span class="k">print</span> <span class="n">exit_message</span>

        <span class="k">return</span> <span class="n">wrapper</span>

    <span class="k">return</span> <span class="n">simple_decorator</span>

<span class="o">@</span><span class="n">decorator_factory</span><span class="p">(</span><span class="s">"Start"</span><span class="p">,</span> <span class="s">"End"</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">hello</span><span class="p">():</span>
    <span class="k">print</span> <span class="s">"Hello World"</span>

<span class="n">hello</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Start
Hello World
End
</code></pre></div></div>

<hr />

<h3 id="route">route</h3>
<p>route çš„æ„æ€æ˜¯ã€Œè·¯ï¼›è·¯ç·šï¼›è·¯ç¨‹ï¼›èˆªç·šï¼›è·¯ç”±ã€ï¼Œåœ¨é€™è£¡å‰‡æ˜¯æŒ‡å®šç¶²å€çš„è·¯å¾‘ã€‚</p>

<p>å› æ­¤ï¼Œè¦å°‡ç¶²å€çš„è·¯å¾‘æŒ‡å®šç‚º<code class="language-plaintext highlighter-rouge">hello</code>å‰‡å¯ä»¥å¯«æˆ</p>
<pre><code class="language-python=">@app.route('/hello')
</code></pre>

<ul>
  <li>æ›´å¤š<code class="language-plaintext highlighter-rouge">@app.route()</code>çš„ç”¨æ³•ï¼š<a href="https://pythonbasics.org/flask-tutorial-routes/">Flask Tutorial: Routes</a></li>
</ul>

<hr />

<h2 id="å°‡-html-ç¨ç«‹å‡ºä¾†">å°‡ html ç¨ç«‹å‡ºä¾†</h2>

<p>å°‡ html ç¨ç«‹å‡ºä¾†æ’°å¯«ï¼Œä¸¦ä½¿ç”¨ <code class="language-plaintext highlighter-rouge">render_template()</code> è®€å–ã€‚flask æœƒå¾ <strong>templates</strong> è³‡æ–™å¤¾æœå°‹é€™å€‹ html æª”æ¡ˆï¼Œä¸¦å›å‚³ã€‚æ‰€ä»¥æª”æ¡ˆçš„çµæ§‹æœƒæ˜¯</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># æª”æ¡ˆçµæ§‹
|- templates
|   |_ index.html
|_ webapp.py
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># webapp.py
</span><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">render_template</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

<span class="o">@</span><span class="n">app</span><span class="p">.</span><span class="n">route</span><span class="p">(</span><span class="s">'/'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="c1"># return 'Index page'
</span>    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s">'index.html'</span><span class="p">)</span>


<span class="o">@</span><span class="n">app</span><span class="p">.</span><span class="n">route</span><span class="p">(</span><span class="s">'/hello'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">hello</span><span class="p">():</span>
    <span class="k">return</span> <span class="s">'Hello World!!'</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
     <span class="n">app</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!-- index.html --&gt;</span>
<span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
<span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">"utf-8"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;title&gt;</span>Flask frame work<span class="nt">&lt;/title&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;h1&gt;</span>I'm the best!<span class="nt">&lt;/h1&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre></div></div>

<hr />
<h3 id="å¢åŠ -html-layout-èˆ‡-css">å¢åŠ  html layout èˆ‡ css</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># æª”æ¡ˆçµæ§‹
|- static
|   |_ css
|       |_main.css 
|- templates
|   |- index.html
|   |_ layout.html
|_ webapp.py
</code></pre></div></div>

<div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">/*main.css*/</span>
<span class="nt">body</span> <span class="p">{</span>
    <span class="nl">font-family</span><span class="p">:</span> <span class="nb">sans-serif</span><span class="p">;</span>
    <span class="nl">margin</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!-- layout.html --&gt;</span>
<span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
<span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">"utf-8"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">type=</span><span class="s">"text/css"</span> <span class="na">href=</span><span class="s">"{{ url_for('static', filename='css/main.css') }}"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;title&gt;</span>{% block head %} {% endblock %}<span class="nt">&lt;/title&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>
    {% block body %} {% endblock %}
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre></div></div>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!-- index.html --&gt;</span>
{% extends "layout.html" %}
{% block head %}
    This is title
{% endblock head %}

{% block body %}
    <span class="nt">&lt;h1&gt;</span>Index Page<span class="nt">&lt;/h1&gt;</span>
{% endblock body %}
</code></pre></div></div>

<h4 id="template-engine---jinja">Template Engine - Jinja</h4>
<ul>
  <li><strong>Jinja</strong> is a web <strong>Template Engine</strong> for Python
    <ul>
      <li>Jinja is Flaskâ€™s default template engine</li>
      <li>é€é Template Engineï¼ˆæ¨¡æ¿å¼•æ“ï¼‰å¯ä»¥åœ¨éœæ…‹çš„ HTML åŠ å…¥è®Šæ•¸ï¼Œå‹•æ…‹çš„ render å‡º HTMLï¼Œå‹•æ…‹å»ºç«‹HTML</li>
      <li>å¯ä»¥ä½¿ç”¨è®Šæ•¸ã€æ¢ä»¶ã€è¿´åœˆä¾†æ’°å¯«æ›´ç°¡æ½”çš„ codeï¼Œèƒ½å¤ æ›´è¼•é¬†çš„ç¶­è­·ç¨‹å¼ç¢¼
<img src="https://i.imgur.com/oaRqhxd.png =200x380" alt="" /></li>
    </ul>
  </li>
  <li>å¸¸ç”¨èªæ³•
    <ul>
      <li>comments: <code class="language-plaintext highlighter-rouge">{# comments #}</code></li>
      <li>variables
        <ul>
          <li><code class="language-plaintext highlighter-rouge">{{ post.title }}</code></li>
          <li>dictionary: <code class="language-plaintext highlighter-rouge">{{your_dict['key']}}</code></li>
          <li>list: <code class="language-plaintext highlighter-rouge">{{your_list[0]}}</code></li>
        </ul>
      </li>
      <li>å¤šè¡Œä»£ç¢¼ï¼š<code class="language-plaintext highlighter-rouge">{% é–‹å§‹ %} HTMLæ¨™ç±¤ {% çµæŸ %}</code></li>
    </ul>
  </li>
  <li><a href="https://segmentfault.com/a/1190000018002480">ä¸€ç¯‡æ–‡ç« ææ‡‚Jinja2 Template Engine æ¨¡ç‰ˆå¼•æ“</a></li>
  <li><a href="https://ithelp.ithome.com.tw/articles/10158878">Day8â€“ å‰ç«¯å°å­—å…¸ä¸‰åå¤©ã€æ¯æ—¥ä¸€å­—ã€‘â€“ Template Engine</a></li>
</ul>

<hr />

<h3 id="å°‡-webapppy-åˆ†è§£">å°‡ webapp.py åˆ†è§£</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># æª”æ¡ˆçµæ§‹
|- run.py
|_ plotlyapp
    |- static
    |   |_ css
    |       |_main.css 
    |- templates
    |   |- index.html
    |   |_ layout.html
    |- __init__.py
    |_ routes.py
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># run.py
</span><span class="kn">from</span> <span class="nn">plotlyapp</span> <span class="kn">import</span> <span class="n">app</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
     <span class="n">app</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># __init__.py
</span><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">plotlyapp</span> <span class="kn">import</span> <span class="n">routes</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># routes.py
</span><span class="kn">from</span> <span class="nn">plotlyapp</span> <span class="kn">import</span> <span class="n">app</span>
<span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">render_template</span><span class="p">,</span> <span class="n">url_for</span>

<span class="o">@</span><span class="n">app</span><span class="p">.</span><span class="n">route</span><span class="p">(</span><span class="s">'/'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s">'index.html'</span><span class="p">)</span>


<span class="o">@</span><span class="n">app</span><span class="p">.</span><span class="n">route</span><span class="p">(</span><span class="s">'/hello'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">hello</span><span class="p">():</span>
    <span class="k">return</span> <span class="s">'Hello World!!'</span>
</code></pre></div></div>

<p><strong>åŸ·è¡Œ web app</strong></p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python run.py
</code></pre></div></div>

<hr />

<p><strong>Reference:</strong></p>
<ul>
  <li><a href="https://clay-atlas.com/blog/2020/02/21/python-flask-chinese-notes-0-build-simple-page/">[Python] Flask å­¸ç¿’å¿ƒå¾—ç­†è¨˜ (0): å»ºç«‹ä¸€å€‹åŸºæœ¬çš„éœæ…‹ç¶²é </a></li>
  <li><a href="https://hackmd.io/@shaoeChen/HJiZtEngG/https%3A%2F%2Fhackmd.io%2Fs%2FHyY5Rq5kG">Book_Python Flaskå¯¦ä½œè¨˜éŒ„</a></li>
  <li><a href="https://www.youtube.com/watch?v=Z1RJmh_OqeA">Learn Flask for Python - Full Tutorial</a></li>
  <li><a href="https://www.youtube.com/watch?v=MwZwr5Tvyxo&amp;list=PL-osiE80TeTs4UjLw5MM6OjgkjFeUxCYH">Python Flask Tutorial: Full-Featured Web App Part 1 - Getting Started</a></li>
</ul>
:ET