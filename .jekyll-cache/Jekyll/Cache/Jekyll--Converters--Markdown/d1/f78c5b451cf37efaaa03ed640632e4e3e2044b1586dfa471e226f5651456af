I"ğ/<p><img src="http://localhost:4000/blog/img/posts/splines%20scatter%20plot.png" alt="splines scatter plot.png" height="380px" width="600px" /></p>

<p>ä¸Šåœ–æ˜¯ä¸€å€‹ x, y çš„åˆ†ä½ˆåœ–ï¼Œç´…ç·šæ˜¯é€™äº›é»åˆ†éƒ¨çš„æ–¹ç¨‹å¼ã€‚ä½†ç¾å¯¦ä¸­ï¼Œæˆ‘å€‘ä¸¦ç„¡æ³•çœŸçš„çŸ¥é“ç´…ç·šçš„æ–¹ç¨‹å¼ï¼Œæˆ‘å€‘å¯èƒ½ä½¿ç”¨ä¸€æ¬¡æ–¹ç¨‹å¼ã€äºŒæ¬¡æ–¹ç¨‹å¼ç”šè‡³æ›´é«˜æ¬¡æ–¹çš„æ–¹ç¨‹å¼å»å˜—è©¦ï¼ˆå¦‚ä¸‹åœ–
ï¼‰ã€‚
<img src="http://localhost:4000/blog/img/posts/splines%20line.png" alt="splines line.png" height="380px" width="600px" /></p>

<p>æˆ‘å€‘å¯ä»¥å°‡æ“¬åˆçš„å¤šé …å¼æ–¹ç¨‹å¼ï¼ˆpolynomial functionï¼‰å¯«æˆï¼Œ</p>

<p>\(y = \beta_0 + \beta_1 x^1 + \beta_2 x^2 + â€¦ + \beta_n x^n + \epsilon\)</p>

<p>ä½†åªæ˜¯ä¸€å‘³çš„æé«˜å¤šé …å¼çš„æ¬¡æ–¹åªæ˜¯å¢åŠ æ¨¡å‹çš„è¤‡é›œåº¦æœƒå°è‡´ overfitting çš„å•é¡Œï¼Œåœ¨ testing data ä¸Šçš„çµæœä¹Ÿä¸æœƒå¤ªå¥½ã€‚</p>

<p>é€™æ™‚å€™æˆ‘å€‘å¯ä»¥ä½¿ç”¨ Piecewise å°‡ data åŠƒåˆ†æˆå¤šå€‹å€é–“ï¼Œæ ¹æ“šæ¯å€‹å€é–“çš„ data çµ¦äºˆä¸€å€‹æ¨¡å‹å»æ“¬åˆã€‚</p>

<hr />

<p><strong>Basis function</strong></p>

<p>\(y_i = \beta_0 + \beta_1 b_1(x_i) + \beta_2 b_2(x_i) + â€¦ + \beta_n b_n(x_i) + \epsilon_i\)</p>

<p>é€é \(b_1(X)\)ã€\(b_2(X)\)ã€â€¦â€¦ã€\(b_n(X)\) å¯ä»¥å°‡éç·šæ€§çš„è‡ªè®Šé‡è½‰æ›æˆç·šæ€§ã€‚</p>

<hr />

<p><strong>Piecewise Function</strong></p>

<p>å°‡ data åŠƒåˆ†å¤šå€‹å€æ®µå¾Œï¼Œæ¯å€‹å€æ®µå†å„è‡ªæ‰¾åˆ°å¯ä»¥æ“¬åˆçš„ modelï¼Œmodel å¯ä»¥æ˜¯ä¸€æ¬¡æ–¹ç¨‹å¼ã€äºŒæ¬¡æ–¹ç¨‹å¼æˆ–æ˜¯ä¸‰æ¬¡æ–¹ç¨‹å¼ç­‰ç­‰ï¼Œä¸éä¸‰æ¬¡æ–¹æœ€å¸¸ä½¿ç”¨ã€‚</p>

<p>å¦‚ä¸‹åœ–æ¯å€‹å€æ®µéƒ½æ˜¯ç”¨ä¸€æ¬¡æ–¹ç¨‹å¼å»æ“¬åˆã€‚\(\xi\) ç‚ºå€æ®µçš„åˆ†éš”é»ï¼Œç¨±ç‚º knotï¼Œæ¯å€‹åˆ†æ®µå‡½æ•¸ç¨±ç‚º piecewise functionã€‚</p>

<p><img src="http://localhost:4000/blog/img/posts/piecewise%20linear.png" alt="piecewise linear.png" height="600px" width="500px" />
From: ã€ŠElements of Statistical Learningã€‹</p>

<p>ä½†é€™äº› piecewise function æ˜¯æœ‰æ¢ä»¶çš„ã€‚
<br />
é›–ç„¶ piecewise function æ˜¯æ¯å€‹å€æ®µå„è‡ªæ“¬åˆå‡ºä¾†çš„ functionï¼Œä½†æ‰€æœ‰å€æ®µ function å¿…é ˆæ•´å€‹ç‚ºé€£çºŒï¼Œä¹Ÿå°±æ˜¯åœ¨ \(\xi\) çš„äº¤ç•Œè™•çš„å€¼å¿…é ˆç›¸åŒã€‚</p>

<hr />

<p><strong>Cubic Spline</strong></p>

<p>é€™è£¡å‰‡æ˜¯ä½¿ç”¨ä¸‰æ¬¡æ–¹ç¨‹å¼ã€‚</p>

<p><img src="http://localhost:4000/blog/img/posts/piecewise%20cubic%20polynomials.png" alt="piecewise cubic polynomials.png" height="600px" width="500px" />
From: ã€ŠElements of Statistical Learningã€‹</p>

<p>cubic spline é™¤äº†é‚Šç•Œçš„å€¼ç›¸åŒå¤–ï¼Œé‚„å¿…é ˆè¦ä¸€éšå’ŒäºŒéšå€’æ•¸ç›¸åŒã€‚</p>

<p>çœ‹ä¸Šåœ–å·¦ä¸Šçš„åœ–åŠ ä¸Šé‚Šç•Œé€£çºŒå¾Œæˆç‚ºå³ä¸Šï¼Œé›–ç„¶çœ‹èµ·ä¾†æ˜¯é€£çºŒçš„å‡½æ•¸ï¼Œä½†ä¸¦ä¸æ˜¯å®Œç¾çš„æ›²ç·šï¼Œå¦‚æœå†åŠ ä¸Šä¸€éšå°æ•¸ç›¸åŒå°±è®Šæˆå·¦ä¸‹ï¼Œå†åŠ ä¸ŠäºŒéšå°æ•¸å°±å¯ä»¥ç•«å‡ºå³ä¸‹çš„åœ–ã€‚</p>

<hr />

<p>é€™å€‹ R code æ˜¯ç•«å‡ºæœ€ä¸Šé¢åœ–çš„ç¨‹å¼ç¢¼ï¼Œä½¿ç”¨ <a href="https://www.youtube.com/watch?v=bESJ81dyYro">Introduction to Splines</a> è£¡é ­çš„ç¯„ä¾‹ã€‚</p>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">set.seed</span><span class="p">(</span><span class="m">100</span><span class="p">)</span><span class="w">

</span><span class="c1"># function</span><span class="w">
</span><span class="n">f</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">f_x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">0.2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="m">11</span><span class="o">*</span><span class="p">(</span><span class="m">10</span><span class="o">*</span><span class="p">(</span><span class="m">1</span><span class="o">-</span><span class="n">x</span><span class="p">))</span><span class="o">^</span><span class="m">6</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">10</span><span class="o">*</span><span class="p">(</span><span class="m">10</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">^</span><span class="m">3</span><span class="o">*</span><span class="p">(</span><span class="m">1</span><span class="o">-</span><span class="n">x</span><span class="p">)</span><span class="o">^</span><span class="m">10</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">seq</span><span class="p">(</span><span class="n">from</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">500</span><span class="p">)</span><span class="w">
</span><span class="n">f_x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w">
</span><span class="n">eps</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">rnorm</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">500</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">sd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="c1"># epsilon</span><span class="w">
</span><span class="n">y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">f_x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">eps</span><span class="w">

</span><span class="n">d</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.frame</span><span class="p">(</span><span class="w">
  </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w">
  </span><span class="n">f_x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f_x</span><span class="p">,</span><span class="w">
  </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y</span><span class="w">
</span><span class="p">)</span><span class="w">

</span><span class="c1"># plot</span><span class="w">
</span><span class="n">ggplot</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_point</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y</span><span class="p">),</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">geom_line</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f_x</span><span class="p">),</span><span class="w"> </span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"red"</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.8</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">theme_bw</span><span class="p">()</span><span class="w">

</span><span class="n">ggplot</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_point</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">geom_smooth</span><span class="p">(</span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"lm"</span><span class="p">,</span><span class="w"> </span><span class="n">se</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">stat_smooth</span><span class="p">(</span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"lm"</span><span class="p">,</span><span class="w"> </span><span class="n">formula</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">I</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="m">2</span><span class="p">),</span><span class="w"> </span><span class="n">se</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"green"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="c1"># stat_smooth(method = "lm", formula = y ~ x + I(x^2) + I(x^3), se = FALSE, colour = "gold1") +</span><span class="w">
  </span><span class="c1"># stat_smooth(method = 'loess', se = FALSE, colour = "red") +</span><span class="w">
  </span><span class="n">theme_bw</span><span class="p">()</span><span class="w">
</span></code></pre></div></div>

<hr />

<p>Reference:
<br />
<a href="https://zhuanlan.zhihu.com/p/34825299">ä¸€æ–‡è¯»æ‡‚å›å½’æ ·æ¡ï¼ˆregression splinesï¼‰ï¼Œé™„Pythonä»£ç </a>
<br />
<a href="https://www.youtube.com/watch?v=bESJ81dyYro">Introduction to Splines</a>
<br />
<a href="https://www.youtube.com/watch?v=V1JRs6AP1AI">Spline Regression | Non Linear Model | Polynomial Regression</a>
<br />
<a href="https://zh.wikipedia.org/wiki/æ ·æ¡å‡½æ•°">wikipedia - æ¨£æ¢å‡½æ•¸</a>
<br />
<a href="https://datascienceplus.com/cubic-and-smoothing-splines-in-r/">Cubic and Smoothing Splines in R</a>
<br />
<a href="http://www-bcf.usc.edu/~gareth/ISL/ISLR%20Seventh%20Printing.pdf">ã€ŠAn Introduction to Statistical Learning with Applications in Rã€‹</a></p>
:ET