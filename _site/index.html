<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>M.C. Shih &middot; BLOG</title>  
  

  <!-- CSS -->
  <link rel="stylesheet" href="/blog/public/css/poole.css">
  <link rel="stylesheet" href="/blog/public/css/syntax.css">
  <link rel="stylesheet" href="/blog/public/css/hyde.css">
  <link rel="stylesheet" href="/blog/public/css/custom.css">
  <link rel="stylesheet" href="/blog/public/css/fontawesome-all.css">
  <link rel="stylesheet" href="/blog/public/css/fontawesome-all.min.css">
  <!-- <link href="https://use.fontawesome.com/releases/v5.0.8/css/all.css" rel="stylesheet"> -->


  <!--<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface"> -->

  <!-- Icons -->
  <link rel="apple-touch-icon" sizes="16x16" href="/blog/public/apple-touch-icon-16-precomposed.png">
  <link rel="apple-touch-icon" sizes="24x24" href="/blog/public/apple-touch-icon-24-precomposed.png">
  <link rel="apple-touch-icon" sizes="32x32" href="/blog/public/apple-touch-icon-32-precomposed.png">
  <link rel="apple-touch-icon" sizes="48x48" href="/blog/public/apple-touch-icon-48-precomposed.png">
  <link rel="apple-touch-icon" sizes="57x57" href="/blog/public/apple-touch-icon-57-precomposed.png">
  <link rel="apple-touch-icon" sizes="64x64" href="/blog/public/apple-touch-icon-64-precomposed.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/blog/public/apple-touch-icon-72-precomposed.png"> 
  <link rel="apple-touch-icon" sizes="114x114" href="/blog/public/apple-touch-icon-114-precomposed.png"> 
  <link rel="apple-touch-icon" sizes="120x120" href="/blog/public/apple-touch-icon-120-precomposed.png"> 
  <link rel="apple-touch-icon" sizes="144x144" href="/blog/public/apple-touch-icon-144-precomposed.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/blog/public/apple-touch-icon-152-precomposed.png">
  <link rel="apple-touch-icon" sizes="512x512" href="/blog/public/apple-touch-icon-512-precomposed.png">
  <link rel="shortcut icon" href="/blog/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/blogblog/atom.xml">
  <!-- 數學符號 -->
  <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>
</head>


  <body>
  	
    <div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <h1>
        <a href="/blog/">
          M.C. Shih
        </a>
        <img src="/blog/img/headshot.png" alt="Author Image" class="headshot">
      </h1>
      <p class="lead">Just for learning.</p>
    </div>

    <nav class="sidebar-nav">
      <a class="sidebar-nav-item active" href="/blog/">Blog</a>

      

      
      
        
          
        
      
        
          
            <a class="sidebar-nav-item" href="/blog/about/">About</a>
          
        
      
        
          
            <a class="sidebar-nav-item" href="/blog/archive/">Archives</a>
          
        
      
        
      
        
          
            <a class="sidebar-nav-item" href="/blog/category/">Category</a>
          
        
      
        
          
        
      
        
          
        
      
        
          
            <a class="sidebar-nav-item" href="/blog/search/">Search</a>
          
        
      
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      

    </nav>
    <div class="links">
      <ul>
        <li><a href="https://shihs.github.io" class="homepage" target="_blank"><img src="/blog/img/link%20icon/iconmonstr-home-6-240.png"></a></li>
        <li><a href="https://github.com/shihs" class="github" target="_blank"><img src="/blog/img/link%20icon/iconmonstr-github-3-240.png"></a></li>
        <li><a href="https://www.linkedin.com/in/min-chun-shih-6647779a/" class="linkedin" target="_blank"><img src="/blog/img/link%20icon/iconmonstr-linkedin-3-240.png"></a></li>
        <li><a href="https://www.instagram.com/itakephotos_tw/" class="instagram" target="_blank"><img src="/blog/img/link%20icon/iconmonstr-instagram-8-240.png"></a></li>
        <li><a href="https://www.flickr.com/photos/mcshihs/" class="flickr" target="_blank"><img src="/blog/img/link%20icon/iconmonstr-flickr-3-240.png"></a></li>
      </ul>
    </div>
    

    <p class = "rights">&copy; 2022. All rights reserved.</p>
  </div>
</div>


    <div class="content container">
      <div class="posts" id="begin">
  
  <div class="post">
    <h1 class="post-title">
      <a href="/blog/python/2022/04/05/Python-%E5%9C%A8-Mac-%E4%B8%8B%E8%BC%89%E8%88%87%E5%AE%89%E8%A3%9D-Miniconda/">
        [Python]在 Mac 下載與安裝 Miniconda
      </a>
    </h1>

    <div class="post-info">
      <!-- <span class="post-date">Posted by Shihs on April 5, 2022</span> -->
      <i class="fas fa-calendar-alt"></i>
      <span class="post-date">April 5, 2022</span>
      <span class="post-categories">
      <!-- <i class="fas fa-tag"></i> -->
      <!-- <i class="far fa-book"></i> -->
      <i class="fas fa-box"></i>
      
      
        <a target="_blank" href="/blog/category/#Python">Python</a>
        
      
    </span>


    </div>
    <!-- <p>Conda 是除了能夠管理套件也能夠管理工作環境，是個好用的工具。
之前是下載 Anaconda 來使用 Conda，但 Anaconda 在最一開始下載時就會下載很多套件，可是大多數的套件其實都用不到，卻又佔用了大量的空間（Anaconda 在刪除前在我的電腦佔用了十幾 GB），因此決定轉換使用 Miniconda 來使用 conda。</p>

<h2 id="刪除-anaconda">刪除 Anaconda</h2>

<p>參考官網的 <a href="https://docs.anaconda.com/anaconda/install/uninstall/">uninstall Anaconda</a> 的方法。</p>

<p>原本想使用第二種方法 <code class="highlighter-rouge">conda install anaconda-clean</code>，但在下載 <code class="highlighter-rouge">anaconda-clean</code> 時一直碰到問題，所以最後決定使用第一種方法。</p>

<p>直接刪除整個 <code class="highlighter-rouge">rm -rf ~/anaconda3</code> 資料夾，為避免這種刪法沒有刪乾淨，再手動搜尋 <code class="highlighter-rouge">anaconda</code> 刪除所有相關的檔案。</p>

<h2 id="下載與安裝-miniconda">下載與安裝 Miniconda</h2>

<ol>
  <li>到官網下載 <a href="https://docs.conda.io/en/latest/miniconda.html">Miniconda</a>
    <ul>
      <li>根據步驟一直點選下一步就好</li>
    </ul>
  </li>
  <li>安裝完成後，Miniconda 會自動在 <code class="highlighter-rouge">.zchrc</code> 和 <code class="highlighter-rouge">.bash_profile</code> 加上路徑
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="c"># &gt;&gt;&gt; conda initialize &gt;&gt;&gt;</span>
 <span class="c"># !! Contents within this block are managed by 'conda init' !!</span>
 <span class="nv">__conda_setup</span><span class="o">=</span><span class="s2">"</span><span class="k">$(</span><span class="s1">'/Users/your_user_name/opt/miniconda3/bin/conda'</span> <span class="s1">'shell.bash'</span> <span class="s1">'hook'</span> 2&gt; /dev/null<span class="k">)</span><span class="s2">"</span>
 <span class="k">if</span> <span class="o">[</span> <span class="nv">$?</span> <span class="nt">-eq</span> 0 <span class="o">]</span><span class="p">;</span> <span class="k">then
     </span><span class="nb">eval</span> <span class="s2">"</span><span class="nv">$__conda_setup</span><span class="s2">"</span>
 <span class="k">else
     if</span> <span class="o">[</span> <span class="nt">-f</span> <span class="s2">"/Users/your_user_name/opt/miniconda3/etc/profile.d/conda.sh"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
         <span class="nb">.</span> <span class="s2">"/Users/your_user_name/opt/miniconda3/etc/profile.d/conda.sh"</span>
     <span class="k">else
         </span><span class="nb">export </span><span class="nv">PATH</span><span class="o">=</span><span class="s2">"/Users/your_user_name/opt/miniconda3/bin:</span><span class="nv">$PATH</span><span class="s2">"</span>
     <span class="k">fi
 fi
 </span><span class="nb">unset </span>__conda_setup
 <span class="c"># &lt;&lt;&lt; conda initialize &lt;&lt;&lt;</span>
</code></pre></div>    </div>
  </li>
  <li>確認是否安裝成功
    <ul>
      <li>打開 terminal，<code class="highlighter-rouge">conda --version</code> 如果能正確顯示 conda 版本，就表示 conda 順利安裝完成！</li>
    </ul>
  </li>
</ol>

<h2 id="conda-常用指令">conda 常用指令</h2>

<h3 id="cheatsheet">Cheatsheet</h3>
<ul>
  <li><a href="https://docs.conda.io/projects/conda/en/4.6.0/_downloads/52a95608c49671267e40c689e0bc00ca/conda-cheatsheet.pdf">Document</a></li>
</ul>

<p><strong>conda 的資訊</strong></p>
<ul>
  <li><code class="highlighter-rouge">conda --version</code>：檢視 conda 版本</li>
  <li><code class="highlighter-rouge">conda update conda</code>：更新 conda 版本</li>
  <li><code class="highlighter-rouge">conda env list</code>：conda 所有的環境</li>
</ul>

<p><strong>conda basic</strong></p>
<ul>
  <li><code class="highlighter-rouge">conda install PACKAGENAME</code>：Install a package included in Anaconda</li>
  <li><code class="highlighter-rouge">conda update PACKAGENAME</code>：Update any installed program</li>
</ul>

<p><strong>環境</strong></p>
<ul>
  <li><code class="highlighter-rouge">conda create --name ENV_NAME python=VERSION</code>：建立特定版本，名稱為<code class="highlighter-rouge">ENV_NAME</code>的環境
    <ul>
      <li>Ex. <code class="highlighter-rouge">conda create --name myenv python=3.6</code></li>
    </ul>
  </li>
  <li><code class="highlighter-rouge">conda activate ENVIRONMENT</code>：切換至指定工作環境</li>
  <li><code class="highlighter-rouge">conda deactivate</code>：回到 base 工作環境</li>
  <li><code class="highlighter-rouge">conda list</code>：active 環境中的所有套件
    <ul>
      <li><a href="https://stackoverflow.com/questions/62412898/what-does-pypi-in-the-channel-column-of-conda-list-output-imply"><code class="highlighter-rouge">Build Channel</code></a>的<code class="highlighter-rouge">pypi</code>表示是用<code class="highlighter-rouge">pip install PACKAGENAME</code></li>
      <li><code class="highlighter-rouge">pip freeze</code>可以看到所有用<code class="highlighter-rouge">pip install</code>下載的套件
<img src="https://i.imgur.com/gnlRU35.png" alt="" /></li>
    </ul>
  </li>
  <li><code class="highlighter-rouge">conda env remove --name ENV_NAME</code>：刪除名稱為<code class="highlighter-rouge">ENV_NAME</code>的環境</li>
</ul>
 -->
    <div class="post-excerpt"><p>Conda 是除了能夠管理套件也能夠管理工作環境，是個好用的工具。
之前是下載 Anaconda 來使用 Conda，但 Anaconda 在最一開始下載時就會下載很多套件，可是大多數的套件其實都用不到，卻又佔用了大量的空間（Anaconda 在刪除前在我的電腦佔用了十幾 GB），因此決定轉換使用 Miniconda 來使用 conda。</p>

</div>
    

    <div class="bookmark">
      <!-- <i class="far fa-comments"></i> -->
      <i class="fas fa-comments"></i>
      <span>
        


<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
var disqus_config = function () {
        // this.page.url = '/blog//python/2022/04/05/Python-%E5%9C%A8-Mac-%E4%B8%8B%E8%BC%89%E8%88%87%E5%AE%89%E8%A3%9D-Miniconda/#disqus_thread';
        this.page.identifier = '/python/2022/04/05/Python-%E5%9C%A8-Mac-%E4%B8%8B%E8%BC%89%E8%88%87%E5%AE%89%E8%A3%9D-Miniconda/';
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://mcshihs.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>



        <a href="/blog//python/2022/04/05/Python-%E5%9C%A8-Mac-%E4%B8%8B%E8%BC%89%E8%88%87%E5%AE%89%E8%A3%9D-Miniconda/#disqus_thread" data-disqus-identifier="/python/2022/04/05/Python-%E5%9C%A8-Mac-%E4%B8%8B%E8%BC%89%E8%88%87%E5%AE%89%E8%A3%9D-Miniconda/">0 Comments</a>
      </span>

    </div>
    
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/blog/python/2022/04/05/Python-%E8%99%9B%E6%93%AC%E7%92%B0%E5%A2%83-(virtual-environment)-conda-create-%E8%88%87-virtualenv-%E6%AF%94%E8%BC%83/">
        [Python]Python 虛擬環境 (virtual environment) - conda create 與 virtualenv 比較
      </a>
    </h1>

    <div class="post-info">
      <!-- <span class="post-date">Posted by Shihs on April 5, 2022</span> -->
      <i class="fas fa-calendar-alt"></i>
      <span class="post-date">April 5, 2022</span>
      <span class="post-categories">
      <!-- <i class="fas fa-tag"></i> -->
      <!-- <i class="far fa-book"></i> -->
      <i class="fas fa-box"></i>
      
      
        <a target="_blank" href="/blog/category/#Python">Python</a>
        
      
    </span>


    </div>
    <!-- <h2 id="virtualenv">Virtualenv</h2>

<p><code class="highlighter-rouge">virtualenv</code>是用來建立一個獨立的<code class="highlighter-rouge">Python</code>環境的工具，支援 Python2 和 Python3。</p>

<ol>
  <li>安裝 virtualenv：<code class="highlighter-rouge">pip install virtualenv</code></li>
  <li>建立虛擬環境：
    <ul>
      <li>先建立一個資料夾：<code class="highlighter-rouge">mkdir myenv</code></li>
      <li>路徑移到該資料夾：<code class="highlighter-rouge">cd myenv</code></li>
      <li>建立虛擬環境：<code class="highlighter-rouge">virtualenv venv</code></li>
    </ul>
  </li>
  <li>啟動虛擬環境：<code class="highlighter-rouge">source env/bin/activate</code></li>
  <li>在該環境下載套件：<code class="highlighter-rouge">pip install PACKAGE_NAME</code></li>
  <li>停用虛擬環境：<code class="highlighter-rouge">deactivate</code></li>
</ol>

<hr />

<h2 id="conda">Conda</h2>

<blockquote>
  <p>Conda is an open source package management system and environment management system that runs on Windows, macOS and Linux. It was created for Python programs, but it can package and distribute software for any language.</p>
</blockquote>

<p>Conda 是一個開源的跨平台工具軟體，它被設計作為 Python、R、Lua、Scala 與 Java 等任何程式語言的套件、依賴性以及工作環境管理員。傳統 Python 使用者以 pip 作為套件管理員（package manager）、以 venv 作為工作環境管理員（environment manager），而 conda 則達成了「兩個願望、一次滿足」既可以管理套件亦能夠管理工作環境。</p>

<h3 id="在-python-使用-conda">在 Python 使用 conda</h3>
<ul>
  <li>可以下載 <code class="highlighter-rouge">Anaconda</code>（3 GB 以上）或 <code class="highlighter-rouge">Miniconda</code>（400 MB 左右）
    <ul>
      <li><code class="highlighter-rouge">Miniconda</code> installer = Python + conda</li>
      <li><code class="highlighter-rouge">Anaconda</code> installer = Python + conda + meta package anaconda = <code class="highlighter-rouge">Miniconda</code> installer + conda install anaconda</li>
    </ul>
  </li>
</ul>

<p><strong><a href="https://stackoverflow.com/questions/30034840/what-are-the-differences-between-conda-and-anaconda/30057885#30057885">What are the differences between Conda and Anaconda?</a></strong></p>
<ul>
  <li><code class="highlighter-rouge">conda</code> is the package manager. <code class="highlighter-rouge">Anaconda</code> is a set of about a hundred packages including conda, numpy, scipy, ipython notebook, and so on.</li>
  <li><code class="highlighter-rouge">Miniconda</code> is a smaller alternative to Anaconda that is just conda and its dependencies, not those listed above.</li>
  <li>Once you have Miniconda, you can easily install Anaconda into it with <code class="highlighter-rouge">conda install anaconda</code>.</li>
</ul>

<h3 id="下載">下載</h3>
<ul>
  <li>下載 <a href="https://docs.conda.io/en/latest/miniconda.html">Miniconda</a></li>
  <li>下載 <a href="https://www.anaconda.com/products/individual">Anaconda</a></li>
</ul>

<h3 id="cheatsheet">Cheatsheet</h3>
<ul>
  <li><a href="https://docs.conda.io/projects/conda/en/4.6.0/_downloads/52a95608c49671267e40c689e0bc00ca/conda-cheatsheet.pdf">Document</a></li>
</ul>

<p><strong>conda 的資訊</strong></p>
<ul>
  <li><code class="highlighter-rouge">conda --version</code>：檢視 conda 版本</li>
  <li><code class="highlighter-rouge">conda update conda</code>：更新 conda 版本</li>
  <li><code class="highlighter-rouge">conda env list</code>：conda 所有的環境</li>
</ul>

<p><strong>conda basic</strong></p>
<ul>
  <li><code class="highlighter-rouge">conda install PACKAGENAME</code>：Install a package included in Anaconda</li>
  <li><code class="highlighter-rouge">conda update PACKAGENAME</code>：Update any installed program</li>
</ul>

<p><strong>環境</strong></p>
<ul>
  <li><code class="highlighter-rouge">conda create --name ENV_NAME python=VERSION</code>：建立特定版本，名稱為<code class="highlighter-rouge">ENV_NAME</code>的環境
    <ul>
      <li>Ex. <code class="highlighter-rouge">conda create --name myenv python=3.6</code></li>
    </ul>
  </li>
  <li><code class="highlighter-rouge">conda activate ENVIRONMENT</code>：切換至指定工作環境</li>
  <li><code class="highlighter-rouge">conda deactivate</code>：回到 base 工作環境</li>
  <li><code class="highlighter-rouge">conda list</code>：active 環境中的所有套件
    <ul>
      <li><a href="https://stackoverflow.com/questions/62412898/what-does-pypi-in-the-channel-column-of-conda-list-output-imply"><code class="highlighter-rouge">Build Channel</code></a>的<code class="highlighter-rouge">pypi</code>表示是用<code class="highlighter-rouge">pip install PACKAGENAME</code></li>
      <li><code class="highlighter-rouge">pip freeze</code>可以看到所有用<code class="highlighter-rouge">pip install</code>下載的套件
<img src="https://i.imgur.com/yvuy4kT.png" alt="" width="50%" heigh="50%" /></li>
    </ul>
  </li>
  <li><code class="highlighter-rouge">conda env remove --name ENV_NAME</code>：刪除名稱為<code class="highlighter-rouge">ENV_NAME</code>的環境</li>
</ul>

<hr />

<p><strong>Reference</strong>:</p>
<ul>
  <li><a href="https://medium.com/datainpoint/python-essentials-conda-quickstart-1f1e9ecd1025">輕鬆學習 Python：conda 的核心功能</a></li>
  <li><a href="https://medium.com/python4u/python-virtualenv虛擬環境安裝-9d6be2d45db9">Python — Virtualenv虛擬環境安裝</a></li>
</ul>
 -->
    <div class="post-excerpt"><h2 id="virtualenv">Virtualenv</h2>

</div>
    

    <div class="bookmark">
      <!-- <i class="far fa-comments"></i> -->
      <i class="fas fa-comments"></i>
      <span>
        


<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
var disqus_config = function () {
        // this.page.url = '/blog//python/2022/04/05/Python-%E8%99%9B%E6%93%AC%E7%92%B0%E5%A2%83-(virtual-environment)-conda-create-%E8%88%87-virtualenv-%E6%AF%94%E8%BC%83/#disqus_thread';
        this.page.identifier = '/python/2022/04/05/Python-%E8%99%9B%E6%93%AC%E7%92%B0%E5%A2%83-(virtual-environment)-conda-create-%E8%88%87-virtualenv-%E6%AF%94%E8%BC%83/';
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://mcshihs.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>



        <a href="/blog//python/2022/04/05/Python-%E8%99%9B%E6%93%AC%E7%92%B0%E5%A2%83-(virtual-environment)-conda-create-%E8%88%87-virtualenv-%E6%AF%94%E8%BC%83/#disqus_thread" data-disqus-identifier="/python/2022/04/05/Python-%E8%99%9B%E6%93%AC%E7%92%B0%E5%A2%83-(virtual-environment)-conda-create-%E8%88%87-virtualenv-%E6%AF%94%E8%BC%83/">0 Comments</a>
      </span>

    </div>
    
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/blog/web/2021/08/22/Web-MVC-%E6%9E%B6%E6%A7%8B/">
        [Web]MVC 架構
      </a>
    </h1>

    <div class="post-info">
      <!-- <span class="post-date">Posted by Shihs on August 22, 2021</span> -->
      <i class="fas fa-calendar-alt"></i>
      <span class="post-date">August 22, 2021</span>
      <span class="post-categories">
      <!-- <i class="fas fa-tag"></i> -->
      <!-- <i class="far fa-book"></i> -->
      <i class="fas fa-box"></i>
      
      
        <a target="_blank" href="/blog/category/#Web">Web</a>
        
      
    </span>


    </div>
    <!-- <p>這篇簡單地介紹 MVC 架構，若是有任何錯誤觀念，歡迎留言。</p>

<p>之前用 node.js 的 express 加上 MVC 架構寫了一個 <a href="https://github.com/shihs/to-do-list-app">TO DO LIST</a>，也許有這個例子可以更容易理解。</p>

<hr />

<h2 id="what-is-mvc">What is MVC?</h2>

<p>MVC 的三個字母分別表示 Model、View 和 Controller，是一種在軟體開發時的軟體架構 (architectural pattern) ，由 Trygve Reenskaug 在 1978 年提出，是為了 Smalltalk （一種程式語言）所發明的一種軟體架構（<a href="https://zh.wikipedia.org/wiki/MVC">wiki</a>）。</p>

<p>它的設計原則是「<strong>關注點分離</strong> (separation of concerns, SOC) 」，把不同作用的程式碼放在不同的檔案裡，讓大家各司其職。</p>

<hr />

<h2 id="圖解-mvc">圖解 MVC</h2>

<p>下圖簡單的說明了，MVC 的流程。</p>

<p><img src="https://i.imgur.com/bVwaxlv.jpg" alt="" width="90%" heigh="90%" />
<a href="https://www.hellosanta.com.tw/blog/Graphical-MVC-architecture">圖片來源</a></p>

<p>使用者操作網站與網站互動，當使用者點選網頁發出 request（可能登入、點進連結、加入購物車…..等等）後，<strong>Controller</strong> 會去接收這個 User 傳來的 request，並根據請求和 <strong>Model</strong> 要資料，當 <strong>Model</strong> 吐出資料給 <strong>Controller</strong> 後，<strong>Controller</strong> 再把資料丟給 <strong>View</strong> 讓前端去顯示，這時候 User 就會看到前端顯示出剛剛送出 request 後產生的畫面。</p>

<p>從上面的說明可以發現，<strong>Controller</strong> 扮演了重要的角色，它除了接收使用者的要求，也負責協調工作給 <strong>Model</strong> 與 <strong>View</strong>，讓每個部分都獨立專注在自己的工作，彼此之前不會直接的溝通，都是靠 <strong>Controller</strong> 傳話。</p>

<p>我覺得可以想像成 <strong>View</strong> 和 <strong>Model</strong> 各是一個部門，兩個部門有各自負責的工作且彼此之間不會直接對話與干預彼此，而使用者就是老闆，<strong>Controller</strong> 負責把老闆的任務分配給各部門，並作為各個部門之間溝通與傳遞消息的角色，讓 <strong>View</strong> 和 <strong>Model</strong> 不用知道對方在幹嘛也能讓每個任務順利完成。</p>

<p>舉一個例子，有一個使用者輸入帳號和密碼要登入一個網站，當使用者點選登入後會送出 request 到 <strong>Controller</strong>，這時候 <strong>Controller</strong> 將這個消息告訴 <strong>Model</strong>，並請 <strong>Model</strong> 檢查使用者輸入的帳號密碼是否正確，<strong>Model</strong> 收到指令後會去和 DB 確認，確認完之後會將結果傳回給 <strong>Controller</strong>（可能是帳號密碼正確或錯誤），<strong>Controller</strong> 再把這個結果給 <strong>View</strong>，<strong>View</strong> 就能根據結果顯示在網頁上，如果成功就順利登入，如果帳號密碼錯誤就顯示失敗。</p>

<p>下面這個圖，加上了前端和後端，<strong>View</strong> 負責的內容會是使用者看到的畫面（前端），而 <strong>Controller</strong> 和 <strong>Model</strong> 是使用者不會注意到背後運作的東西，而與 DB 拿資料就是 <strong>Model</strong> 的任務。</p>

<p><img src="https://dotblogsfile.blob.core.windows.net/user/%E5%B7%A5%E7%A8%8B%E8%89%AF%E7%94%B0/ec9b5c12-03c6-4658-a3f2-85f4bdeaf371/1538274044_80461.png" alt="" width="90%" heigh="90%" />
<a href="https://dotblogs.com.tw/armycoding/2018/09/29/164045">圖片來源</a></p>

<hr />

<h2 id="model-view-controller">Model, View, Controller</h2>

<p>下面再來詳細的介紹一下 MVC 它們的工作內容。</p>

<h3 id="controller">Controller</h3>

<p>從上面的圖例我們知道 Controller 是負責接收使用者的 request 並將資料分配給 Model 和 View 的重要角色。它將使用者的 request 傳給 Model，請 Model 去拿取資料，之後再將 Model 給的資料送給 View，讓 View 將資料呈現在前端讓使用者可以看到。</p>

<p>因此 Controller 決定了整個任務的工作流程，並決定最後如何呈現。下面幾個來自「<a href="https://tw.alphacamp.co/blog/mvc-model-view-controller">MVC 架構是什麼？認識 Model-View-Controller 軟體設計模式</a>」的例子</p>

<ul>
  <li>使用者是否需要先登入 (認證) 才可以看到網頁內容？</li>
  <li>使用者是否只能閱讀資料，但不能修改或刪除？</li>
  <li>使用者新增了資料之後，會重新導向至哪個頁面？</li>
</ul>

<h3 id="model">Model</h3>

<p>Model 主要負責和資料庫溝通以及商業邏輯有關的任務。Model 可以直接對資料庫做存取，但它並不關心資料之後如何被顯示或操作。而所謂的商業邏輯可以這樣理解，假設今天有一個滿千折打九折的折扣，像這樣的「商業邏輯」就可以使用一個 model 去處理使用者的訂單；又或者今天在寫一個部落格的網站，就可以有 <em>post</em> 和 <em>comment</em> 這兩個 model 去對資料庫寫進新的文章和留言的功能。</p>

<h3 id="view">View</h3>

<p>網頁的前端，使用者看到的部分，也就是 HTML 的部分。</p>

<hr />

<h2 id="mvc-優點">MVC 優點</h2>

<ul>
  <li>不管是誰寫，檔案存放的邏輯不會差太多</li>
  <li>程式碼可以重複利用（reusable）</li>
  <li>更容易維護程式碼</li>
  <li>方便團隊合作：團隊各在開發時可以各自負責不同部分，不會互相影響</li>
</ul>

<hr />

<h2 id="route-與-mvc-框架">Route 與 MVC 框架</h2>

<p>前面介紹的 MVC 架構當使用者送出 request 後是直接由 <strong>Controller</strong> 去接收做處理，但如果網頁的 request 是由 <strong>Route</strong> 去處理，這樣 <strong>Controller</strong> 接收的訊息就會是由 <strong>Route</strong> 傳送過來的，但其他的工作內容基本上和前面介紹的 MVC 是一樣的。</p>

<p>如果想要具體的了解可以看這篇「<a href="https://ithelp.ithome.com.tw/articles/10194968">Node.js-Backend 見聞錄(10)：關於後端觀念(六)-關於 MVC </a>」，比較具體地介紹 node.js route 的 MVC 架構。</p>

<p><img src="https://2.bp.blogspot.com/-gX62WAgkWWs/VIXBRs6w6SI/AAAAAAAAAvM/hmx8361at9k/s1600/laravel-mvc-components.png" alt="" width="90%" heigh="90%" />
<a href="https://tutorial-4-php.blogspot.com/2014/12/model-view-controller-mvc.html">圖片來源</a></p>

<p>*上圖 Routing 上面的「Laravel」是 PHP 的一個 web framwork，因為圖片來源的文章是在講解 PHP。</p>

<hr />

<ul>
  <li><a href="https://tutorial-4-php.blogspot.com/2014/12/model-view-controller-mvc.html">Model-View-Controller (MVC) </a></li>
  <li><a href="https://tw.alphacamp.co/blog/mvc-model-view-controller">MVC 架構是什麼？認識 Model-View-Controller 軟體設計模式</a></li>
  <li><a href="https://ithelp.ithome.com.tw/articles/10191216">[Day 01] 什麼是 MVC？能吃嗎？ </a></li>
  <li><a href="https://www.ibest.tw/mvc-website.php">什麼是 MVC 網頁設計? 做網站一定需要 MVC 嗎?</a></li>
  <li><a href="https://www.youtube.com/watch?v=zW_tZR0Ir3Q">Node.js Crash Course Tutorial #11 - Express Router &amp; MVC</a></li>
</ul>
 -->
    <div class="post-excerpt"><p>這篇簡單地介紹 MVC 架構，若是有任何錯誤觀念，歡迎留言。</p>

</div>
    

    <div class="bookmark">
      <!-- <i class="far fa-comments"></i> -->
      <i class="fas fa-comments"></i>
      <span>
        


<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
var disqus_config = function () {
        // this.page.url = '/blog//web/2021/08/22/Web-MVC-%E6%9E%B6%E6%A7%8B/#disqus_thread';
        this.page.identifier = '/web/2021/08/22/Web-MVC-%E6%9E%B6%E6%A7%8B/';
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://mcshihs.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>



        <a href="/blog//web/2021/08/22/Web-MVC-%E6%9E%B6%E6%A7%8B/#disqus_thread" data-disqus-identifier="/web/2021/08/22/Web-MVC-%E6%9E%B6%E6%A7%8B/">0 Comments</a>
      </span>

    </div>
    
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/blog/sql/2021/08/16/%E5%9C%A8-Mac-%E6%9C%AC%E6%A9%9F%E5%AE%89%E8%A3%9D-MySQL-&-phpmyadmin/">
        [SQL]在 Mac 本機安裝 MySQL & phpmyadmin
      </a>
    </h1>

    <div class="post-info">
      <!-- <span class="post-date">Posted by Shihs on August 16, 2021</span> -->
      <i class="fas fa-calendar-alt"></i>
      <span class="post-date">August 16, 2021</span>
      <span class="post-categories">
      <!-- <i class="fas fa-tag"></i> -->
      <!-- <i class="far fa-book"></i> -->
      <i class="fas fa-box"></i>
      
      
        <a target="_blank" href="/blog/category/#SQL">SQL</a>
        
      
    </span>


    </div>
    <!-- <h4 id="1-啟動-apache">1. 啟動 Apache</h4>

<ul>
  <li><code class="highlighter-rouge">sudo apachectl start</code></li>
  <li>打開瀏覽器 <a href="http://localhost/">http://localhost/</a> 可以看到 <strong>It works!</strong></li>
</ul>

<h4 id="2-下載-mysql">2. 下載 MySQL</h4>

<ul>
  <li><a href="https://dev.mysql.com/downloads/mysql/">https://dev.mysql.com/downloads/mysql/</a></li>
  <li>選擇下載 <code class="highlighter-rouge">.dmg</code> 檔</li>
  <li>下載完後安裝，安裝過程需要<strong>設定 root 的密碼</strong></li>
  <li>打開系統偏好設定會看到出現 MySQL 的圖示，點選後啟動 MySQL
<img src="https://i.imgur.com/tusQ0GN.png" alt="" width="70%" heigh="70%" />
<img src="https://i.imgur.com/rpAQ8yJ.png" alt="" width="70%" heigh="70%" /></li>
</ul>

<h4 id="3-使用-terminal-開啟-mysql">3. 使用 terminal 開啟 MySQL</h4>

<ul>
  <li><code class="highlighter-rouge">mysql -u root -p</code>（<code class="highlighter-rouge">-u</code>: user, <code class="highlighter-rouge">-p</code>: password）</li>
  <li>出現 <code class="highlighter-rouge">Enter password:</code> 後輸入剛剛安裝時設定的 root 密碼
<img src="https://i.imgur.com/dsXdFmP.png" alt="" width="90%" heigh="90%" /></li>
</ul>

<h4 id="4-下載-phpmyadmin">4. 下載 phpmyadmin</h4>

<p>這個步驟不是必須，下載 phpmyadmin 是為了可以使用操作介面查看 MySQL。</p>

<ul>
  <li>下載 phpmyadmin：<a href="https://www.phpmyadmin.net/downloads/">https://www.phpmyadmin.net/downloads/</a></li>
  <li>瀏覽器打開 <a href="http://localhost/phpmyadmin/index.php">http://localhost/phpmyadmin/index.php</a>
<img src="https://i.imgur.com/orDEaCz.png" alt="" /></li>
</ul>

<h4 id="5-設定-phpmyadmin-登入密碼">5. 設定 phpmyadmin 登入密碼</h4>

<p>因為 phpmyadmin 的密碼身份驗證是 <code class="highlighter-rouge">caching_sha2_password</code> 所以會無法使用一開始設定的 root 與密碼登入，這時候需要先修改 db 的資料。</p>

<ul>
  <li>terminal 登入 MySQL（<a href="https://hackmd.io/xwgJ-FoRSsSVk6WCrgRXlA?view#3-%E4%BD%BF%E7%94%A8-terminal-%E9%96%8B%E5%95%9F-MySQL">step 3</a>）</li>
  <li>將 root 的密碼身份驗證由 <code class="highlighter-rouge">caching_sha2_password</code> 改成 <code class="highlighter-rouge">mysql_native_password</code>
    <ul>
      <li><code class="highlighter-rouge">use mysql；</code>（使用 <code class="highlighter-rouge">mysql</code> 這個 db）</li>
      <li><code class="highlighter-rouge">ALTER USER 'root'@'localhost' IDENTIFIED WITH mysql_native_password BY '你的密碼';</code></li>
      <li><code class="highlighter-rouge">FLUSH PRIVILEGES;</code></li>
    </ul>
  </li>
  <li>這時候 phpmyadmin 就可以使用設定好的 root 的密碼登入了</li>
</ul>

<hr />

<h3 id="新增新的-mysql-user">新增新的 MySQL User</h3>

<p>通常不會讓所有人都使用 root 權限操作 db，這時候就需要增加新的 user 讓其他人使用。</p>

<ul>
  <li>terminal 登入 MySQL（<a href="https://hackmd.io/xwgJ-FoRSsSVk6WCrgRXlA?view#3-%E4%BD%BF%E7%94%A8-terminal-%E9%96%8B%E5%95%9F-MySQL">step 3</a>）</li>
  <li>新增 User
    <ul>
      <li><code class="highlighter-rouge">use mysql；</code></li>
      <li><code class="highlighter-rouge">CREATE USER 'USERNAME'@'localhost' IDENTIFIED BY 'PASSWORD';</code></li>
      <li><code class="highlighter-rouge">ALTER USER 'username'@'localhost' IDENTIFIED WITH mysql_native_password BY 'password';</code></li>
      <li><code class="highlighter-rouge">FLUSH PRIVILEGES;</code></li>
    </ul>
  </li>
  <li>設定完成後 phpmyadmin 和 terminal 都可以使用設定好的帳號密碼登入
    <ul>
      <li><code class="highlighter-rouge">mysql -u USERNAME -p</code> / <code class="highlighter-rouge">PASSWORD</code></li>
    </ul>
  </li>
</ul>

<h4 id="設定新增-user-的權限">設定新增 User 的權限</h4>

<ul>
  <li>查看某 user 的權限：
<code class="highlighter-rouge">SHOW GRANTS FOR 'username'@'localhost';</code></li>
  <li>GRANT 權限：
<code class="highlighter-rouge">GRANT type_of_permission ON database_name.table_name TO 'username'@'localhost';</code></li>
  <li>REVOKE 權限：
<code class="highlighter-rouge">REVOKE type_of_permission ON database_name.table_name FROM 'username'@'localhost';</code></li>
  <li>reload all the privileges：<code class="highlighter-rouge">FLUSH PRIVILEGES;</code></li>
</ul>

<hr />

<p><strong>Reference</strong></p>

<ul>
  <li><a href="https://jqnets.com/blog/mac-%E9%9B%BB%E8%85%A6%E5%9F%B7%E8%A1%8C-php-mysql-phpmyadmin/">Mac 電腦執行 PHP &amp; MySQL &amp; phpMyadmin</a></li>
  <li><a href="https://www.itread01.com/content/1546243084.html">phpmyadmin 連線 MySQL8.0 報錯#2054 - The server requested authentication method unknown to the client</a></li>
  <li><a href="https://phoenixnap.com/kb/how-to-create-new-mysql-user-account-grant-privileges">How To Create New MySQL User and Grant Privileges</a></li>
  <li><a href="https://www.digitalocean.com/community/tutorials/how-to-create-a-new-user-and-grant-permissions-in-mysql">How To Create a New User and Grant Permissions in MySQL</a></li>
</ul>
 -->
    <div class="post-excerpt"><h4 id="1-啟動-apache">1. 啟動 Apache</h4>

</div>
    

    <div class="bookmark">
      <!-- <i class="far fa-comments"></i> -->
      <i class="fas fa-comments"></i>
      <span>
        


<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
var disqus_config = function () {
        // this.page.url = '/blog//sql/2021/08/16/%E5%9C%A8-Mac-%E6%9C%AC%E6%A9%9F%E5%AE%89%E8%A3%9D-MySQL-&-phpmyadmin/#disqus_thread';
        this.page.identifier = '/sql/2021/08/16/%E5%9C%A8-Mac-%E6%9C%AC%E6%A9%9F%E5%AE%89%E8%A3%9D-MySQL-&-phpmyadmin/';
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://mcshihs.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>



        <a href="/blog//sql/2021/08/16/%E5%9C%A8-Mac-%E6%9C%AC%E6%A9%9F%E5%AE%89%E8%A3%9D-MySQL-&-phpmyadmin/#disqus_thread" data-disqus-identifier="/sql/2021/08/16/%E5%9C%A8-Mac-%E6%9C%AC%E6%A9%9F%E5%AE%89%E8%A3%9D-MySQL-&-phpmyadmin/">0 Comments</a>
      </span>

    </div>
    
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/blog/git/2021/08/15/Github-%E6%96%B0%E7%9A%84-authentication-%E8%A8%AD%E5%AE%9A/">
        [Git]Github 新的 authentication 設定
      </a>
    </h1>

    <div class="post-info">
      <!-- <span class="post-date">Posted by Shihs on August 15, 2021</span> -->
      <i class="fas fa-calendar-alt"></i>
      <span class="post-date">August 15, 2021</span>
      <span class="post-categories">
      <!-- <i class="fas fa-tag"></i> -->
      <!-- <i class="far fa-book"></i> -->
      <i class="fas fa-box"></i>
      
      
        <a target="_blank" href="/blog/category/#Git">Git</a>
        
      
    </span>


    </div>
    <!-- <p>Github 從 8/13 開始將以前的 password 認證方式刪除了，這裡記錄我解決的方法。</p>

<ul>
  <li><a href="https://shihs.github.io/blog/2021/08/15/Github-%E6%96%B0%E7%9A%84-authentication-%E8%A8%AD%E5%AE%9A/#1-%E4%BD%BF%E7%94%A8-ssh">使用 ssh</a></li>
  <li><a href="https://shihs.github.io/blog/2021/08/15/Github-%E6%96%B0%E7%9A%84-authentication-%E8%A8%AD%E5%AE%9A/#2-%E4%BD%BF%E7%94%A8-personal-access-token">使用 personal access token</a></li>
</ul>

<hr />

<h3 id="1-使用-ssh">1. 使用 ssh</h3>

<p>情況：</p>

<p><img src="http://localhost:4000/blog/img/posts/git%20push.png" alt="" /></p>

<ul>
  <li>之前已 clone 下來的 repo</li>
  <li>修改後要 push 碰到下面的錯誤訊息</li>
</ul>

<pre><code class="language-bash=">remote: Support for password authentication was removed on August 13, 2021. Please use a personal access token instead.
remote: Please see https://github.blog/2020-12-15-token-authentication-requirements-for-git-operations/ for more information.
fatal: unable to access 'https://github.com/shihs/to-do-list-app.git/': The requested URL returned error: 403
</code></pre>

<p><strong>Step 1:</strong> Enabling two-factor authentication</p>

<ul>
  <li>根據錯誤訊息提供的<a href="https://github.blog/2020-12-15-token-authentication-requirements-for-git-operations/">網址</a>，先去 <strong>Enabling two-factor authentication</strong>，照著 <a href="https://docs.github.com/en/github/authenticating-to-github/securing-your-account-with-two-factor-authentication-2fa/configuring-two-factor-authentication-recovery-methods">Configuring two-factor authentication recovery methods</a> 的步驟做（裡面提到的 TOTP app 我是用 <a href="https://www.salesforce.com/solutions/mobile/app-suite/security/">Salesforce Authenticator</a>）。</li>
</ul>

<p><strong>Step 2:</strong> 加 ssh key</p>

<ul>
  <li>確認 github 是否已經加了 ssh key <code class="highlighter-rouge">ssh -t git@github.com</code>，如果沒加會出現像這樣的訊息<img src="http://localhost:4000/blog/img/posts/ssh%20test.png" alt="" /></li>
  <li>在本機 gen ssh key，並在 github 頁面新增 ssh key。我主要是參考下面兩個網址：
    <ul>
      <li><a href="https://blog.jaycetyle.com/2018/02/github-ssh/">Git 版本控制筆記 - 使用 github 及 ssh 金鑰設定</a></li>
      <li><a href="https://docs.github.com/cn/github/authenticating-to-github/connecting-to-github-with-ssh/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent#adding-your-ssh-key-to-the-ssh-agent">生成新 SSH 密钥并添加到 ssh-agent</a></li>
    </ul>
  </li>
  <li>完成之後在 terminal 打上 <code class="highlighter-rouge">ssh -t git@github.com</code> 會是
<img src="http://localhost:4000/blog/img/posts/ssh%20success.png" alt="" /></li>
</ul>

<p><strong>Step 3:</strong> 重新 push</p>

<ul>
  <li><code class="highlighter-rouge">git remote set-url origin git@github.com:[your-github-name]/[repo-name].git</code></li>
  <li>重新 add 和 commit 修改，就可以 push 了</li>
</ul>

<p>但這樣的方法還是很麻煩……每一支 reop 都要重新 <code class="highlighter-rouge">git remote set-url origin ...</code> 所以另一個方法是使用 <strong>personal access token</strong>。</p>

<p><strong>Reference</strong>:
<a href="https://www.youtube.com/watch?v=5Jz0wVmYUUE">GitHub Support for password authentication was removed (August 13, 2021) - Solution</a></p>

<hr />

<h2 id="2-使用-personal-access-token">2. 使用 personal access token</h2>

<p>這裡的方法是在 Mac 的操作。</p>

<p><strong>Step 1:</strong></p>

<ul>
  <li>參照 github 提供的方法，<a href="https://docs.github.com/en/github/authenticating-to-github/keeping-your-account-and-data-secure/creating-a-personal-access-token">Creating a personal access token</a>。
    <ul>
      <li><strong>Settings</strong> -&gt; <strong>Developer settings</strong> -&gt; <strong>Personal access tokens</strong> -&gt; <strong>Generate new token</strong></li>
    </ul>
  </li>
</ul>

<p><strong>Step 2:</strong> 將 create 出來的 token 加到「鑰匙圈」裡</p>

<ul>
  <li>使用 spotlight 搜尋「keychain」</li>
  <li>在 keychain 上搜尋「github」，找到 github
<img src="http://localhost:4000/blog/img/posts/keychain.png" alt="" width="70%" heigh="70%" /></li>
  <li>點選下方「顯示密碼」，並將密碼改成剛剛在 github 上 create 的 token
<img src="http://localhost:4000/blog/img/posts/add%20token.png" alt="" width="70%" heigh="70%" /></li>
</ul>

<p>現在可以任意地使用之前 clone 下來的 repo 了，不過如果剛剛 create token 有時間限制，之後必須要再重新建立新的密碼並修改。</p>

<p><strong>Reference</strong>:
<a href="https://www.youtube.com/watch?v=aKaYpl-ZpGg">Solved - Support for password authentication was removed - Github - Mac and Windows</a></p>
 -->
    <div class="post-excerpt"><p>Github 從 8/13 開始將以前的 password 認證方式刪除了，這裡記錄我解決的方法。</p>

</div>
    

    <div class="bookmark">
      <!-- <i class="far fa-comments"></i> -->
      <i class="fas fa-comments"></i>
      <span>
        


<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
var disqus_config = function () {
        // this.page.url = '/blog//git/2021/08/15/Github-%E6%96%B0%E7%9A%84-authentication-%E8%A8%AD%E5%AE%9A/#disqus_thread';
        this.page.identifier = '/git/2021/08/15/Github-%E6%96%B0%E7%9A%84-authentication-%E8%A8%AD%E5%AE%9A/';
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://mcshihs.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>



        <a href="/blog//git/2021/08/15/Github-%E6%96%B0%E7%9A%84-authentication-%E8%A8%AD%E5%AE%9A/#disqus_thread" data-disqus-identifier="/git/2021/08/15/Github-%E6%96%B0%E7%9A%84-authentication-%E8%A8%AD%E5%AE%9A/">0 Comments</a>
      </span>

    </div>
    
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/blog/%E5%89%8D%E7%AB%AF/2021/03/07/%E5%89%8D%E7%AB%AF-Cookie-&-Session/">
        [前端]Cookie & Session
      </a>
    </h1>

    <div class="post-info">
      <!-- <span class="post-date">Posted by Shihs on March 7, 2021</span> -->
      <i class="fas fa-calendar-alt"></i>
      <span class="post-date">March 7, 2021</span>
      <span class="post-categories">
      <!-- <i class="fas fa-tag"></i> -->
      <!-- <i class="far fa-book"></i> -->
      <i class="fas fa-box"></i>
      
      
        <a target="_blank" href="/blog/category/#前端">前端</a>
        
      
    </span>


    </div>
    <!-- <p>在邊閱讀網路資訊的時候，我對於 cookie 和 session 從覺得理解到感到困惑，到後來又覺得好像懂了，但也許不是百分之百正確。我盡量把理解的東西寫下來，但如果有任何錯誤，歡迎指正。</p>

<hr />

<h3 id="重點">重點</h3>

<p>Session 和 Cookie 的目的是用來讓 Sever 知道 Client 的狀態，而 Cookie 是將狀態資料存在 Client 端（Browser），而 Session 則是將資料存在 Server 端（e.g Redis）</p>

<hr />

<h3 id="http-的-stateless無狀態">HTTP 的 stateless（無狀態）</h3>

<p>前面說到「Session 和 Cookie 的目的是用來讓 Sever 知道 Client 的狀態」，但</p>

<ol>
  <li>為什麼 Server 不知道 Client 的狀態呢？</li>
  <li>為什麼需要讓 Sever 知道 Client 的狀態呢？</li>
</ol>

<p><img src="http://wiki.hashphp.org/images/6/67/HTTP_Model.jpg" alt="HTTP Model" width="50%" heigh="50%" /></p>

<p>要回答第一個問題，就要先知道「<strong>HTTP 是 stateless（無狀態）</strong>」，而 stateless（無狀態）的定義是</p>

<ul>
  <li>Server 和 Client 不會記住（retain）之前的連線</li>
  <li>每個 Client 送出的 request 都被視為是唯一且獨立的 connection</li>
</ul>

<p>舉個例子，</p>

<p><a href="https://dotblogs.com.tw/jimmyyu/2010/10/16/difference-between-stateful-and-stateless">https://dotblogs.com.tw/jimmyyu/2010/10/16/difference-between-stateful-and-stateless</a></p>

<p>上面這個網址是我在搜尋「無狀態」時找到覺得解釋得不錯的部落格，而我從我的瀏覽器打開這個網頁，和你從你的瀏覽器輸入這個網址打開，基本是上一樣的，並不需要先連到其他網頁，像這樣子的情況就稱為 stateless（無狀態）。</p>

<p>解決第一個問題後，那 stateless 就 stateless 啊，為什麼要讓 Server 知道 Client 的狀態呢？</p>

<p>想想看，我們在使用 facebook 或是 instagram 等等很多網站都必須要先登入後才能觀看到想看到的頁面；或是，在網拍網站上如果我們把東西加到購物車，當下次登入時打開，還能夠看到上次加入的商品。但以剛剛 stateless（無狀態）的邏輯來思考，這件事情是不可能可以達成的，因為假如每次的 request 都是獨立且唯一的，那這樣每一次重新點選網頁都會是一個新的事件，Server 就像是失憶一樣，根本不會記得曾經發生過什麼事情，所以當 Client 端做了改變（ex. 登入、商品加入購物車…等等），Sever 端並不會知道，當我們想要做任何事情，每一次都必須要重新來一遍才行。</p>

<p>這就是為什麼我們會想要讓 Server 知道 Client 的狀態了（Stateful）。</p>

<hr />

<h3 id="cookie-是什麼">Cookie 是什麼？</h3>

<p>Cookie 是用來記錄 Client 與 Server 目前的溝通狀態，會以 name-value 的形式呈現，並且存在 Client 端。</p>

<p><img src="http://localhost:4000/blog/img/posts/cookie.png" alt="進入 googlec.com 後得到的 cookie" width="80%" heigh="80%" /></p>

<p>而這個 cookie 在 Client 端第一次發送 request 後，Server 會以 <code class="highlighter-rouge">Set-Cookie</code> 的方式寫在 response header，回應給 Client，而 Client 瀏覽器就會將這個 Cookie 存在本機端，下一次要再次送 request 時，會把這個已儲存的 Cookie 已 <code class="highlighter-rouge">Cookie</code> 的方式存在 resquest header 和 request 一起送出，讓 Sever 知道這個 Client 目前的狀態。（可以用 Chrome 的開法者模式看 network 中網頁的 Response Headers 和 Request Headers 找到 <code class="highlighter-rouge">Set-Cookie</code> 和 <code class="highlighter-rouge">Cookie</code>）</p>

<p>但這樣儲存 Cookie 又會有什麼問題呢？</p>

<ol>
  <li>
    <p>Cookie size 的限制：根據 RFC-2965 的規定，一個 Cookie 最大只能是 4096 bytes。</p>
  </li>
  <li>
    <p>佔據網路流量：由於每次 request 都會傳送 Cookie 資料，所以當 Cookie 資料越來越大，request 傳輸的資訊也會更著變大，這樣就會影響網路傳輸的速度。</p>
  </li>
  <li>
    <p>Cookie 可能被 Client 竄改：由於 Cookie 存在 Client 端，所以 Client 是可以完整的看到 Cookie 資料的，那如果 Cookie 竄改或者是外洩，這樣就存在著資安的風險。</p>
  </li>
</ol>

<p>根據以上的問題，我們可以知道，Cookie 中不能存放有資安疑慮的資料，也不能存放太大的資訊量。所以為了彌補這些不足，就有了 Session 的出現。</p>

<hr />

<h3 id="session-是什麼">Session 是什麼？</h3>

<p>Session 是一種比 Cookie 更安全的狀態管理機制。</p>

<p>既然 Session 是為了彌補 Cookie 的不足，它就必須要解決上面提到的 Cookie 可能會有的問題。所以 Session 會將狀態資訊存在 Sever 端，以避免 Client 端可以任意修改資訊，此方法也能避免儲存與傳輸的資料過大的問題。</p>

<p>而為了要讓 Client 端知道 Session 儲存的資訊，Server 端會在 response 的 Cookie 中回傳一組 SessionID 讓 Client 儲存在 Cookie 裡，當下次 Client 送出 request 時，就在 Cookie 裡一起送出這組 SessionID，而 Server 就可以透過這組 SessionID 去驗證這個 Client 身份，並知道上一次儲存的狀態，然後回傳內容。</p>

<hr />

<p><strong>Reference:</strong>
<br />
<a href="https://hulitw.medium.com/session-and-cookie-15e47ed838bc">前端三十｜27. [WEB] Cookie &amp; Session 是什麼？</a>
<br />
<a href="https://dotblogs.com.tw/jimmyyu/2010/10/16/difference-between-stateful-and-stateless">[ASP.NET]Stateful與Stateless</a>
<br />
<a href="https://hulitw.medium.com/session-and-cookie-15e47ed838bc">白話 Session 與 Cookie：從經營雜貨店開始</a>
<br />
<a href="https://medium.com/@vicxu/authentication-那些小事上集-cookie-與-session-介紹-1da2d413afa2">淺談 Authentication 上集：Cookie 與 Session 介紹</a></p>

 -->
    <div class="post-excerpt"><p>在邊閱讀網路資訊的時候，我對於 cookie 和 session 從覺得理解到感到困惑，到後來又覺得好像懂了，但也許不是百分之百正確。我盡量把理解的東西寫下來，但如果有任何錯誤，歡迎指正。</p>

</div>
    

    <div class="bookmark">
      <!-- <i class="far fa-comments"></i> -->
      <i class="fas fa-comments"></i>
      <span>
        


<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
var disqus_config = function () {
        // this.page.url = '/blog//%E5%89%8D%E7%AB%AF/2021/03/07/%E5%89%8D%E7%AB%AF-Cookie-&-Session/#disqus_thread';
        this.page.identifier = '/%E5%89%8D%E7%AB%AF/2021/03/07/%E5%89%8D%E7%AB%AF-Cookie-&-Session/';
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://mcshihs.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>



        <a href="/blog//%E5%89%8D%E7%AB%AF/2021/03/07/%E5%89%8D%E7%AB%AF-Cookie-&-Session/#disqus_thread" data-disqus-identifier="/%E5%89%8D%E7%AB%AF/2021/03/07/%E5%89%8D%E7%AB%AF-Cookie-&-Session/">0 Comments</a>
      </span>

    </div>
    
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/blog/python/2021/01/22/Python-asyncio-%E5%92%8C-await/">
        [Python]asyncio 和 await
      </a>
    </h1>

    <div class="post-info">
      <!-- <span class="post-date">Posted by Shihs on January 22, 2021</span> -->
      <i class="fas fa-calendar-alt"></i>
      <span class="post-date">January 22, 2021</span>
      <span class="post-categories">
      <!-- <i class="fas fa-tag"></i> -->
      <!-- <i class="far fa-book"></i> -->
      <i class="fas fa-box"></i>
      
      
        <a target="_blank" href="/blog/category/#Python">Python</a>
        
      
    </span>


    </div>
    <!-- <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">asyncio</span>

<span class="n">url</span> <span class="o">=</span> <span class="s">'https://www.google.com.tw/'</span>
<span class="n">loop</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">get_event_loop</span><span class="p">()</span>

<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="k">async</span> <span class="k">def</span> <span class="nf">send_req</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"Send a request at"</span><span class="p">,</span><span class="n">t</span><span class="o">-</span><span class="n">start_time</span><span class="p">,</span><span class="s">"seconds."</span><span class="p">)</span>

    <span class="n">res</span> <span class="o">=</span> <span class="k">await</span> <span class="n">loop</span><span class="o">.</span><span class="n">run_in_executor</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span><span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">,</span><span class="n">url</span><span class="p">)</span>

    <span class="n">t</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"Receive a response at"</span><span class="p">,</span><span class="n">t</span><span class="o">-</span><span class="n">start_time</span><span class="p">,</span><span class="s">"seconds."</span><span class="p">)</span>

<span class="n">tasks</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">task</span> <span class="o">=</span> <span class="n">loop</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">send_req</span><span class="p">(</span><span class="n">url</span><span class="p">))</span>
    <span class="n">tasks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">task</span><span class="p">)</span>

<span class="n">loop</span><span class="o">.</span><span class="n">run_until_complete</span><span class="p">(</span><span class="n">asyncio</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="n">tasks</span><span class="p">))</span>
</code></pre></div></div>

<hr />

<p><strong>Reference:</strong>
<br />
<a href="https://ithelp.ithome.com.tw/articles/10199385">python的asyncio模組(一)：異步執行的好處</a>
<br /></p>
 -->
    <div class="post-excerpt"><p>```python
import requests
import time
import asyncio</p>

</div>
    

    <div class="bookmark">
      <!-- <i class="far fa-comments"></i> -->
      <i class="fas fa-comments"></i>
      <span>
        


<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
var disqus_config = function () {
        // this.page.url = '/blog//python/2021/01/22/Python-asyncio-%E5%92%8C-await/#disqus_thread';
        this.page.identifier = '/python/2021/01/22/Python-asyncio-%E5%92%8C-await/';
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://mcshihs.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>



        <a href="/blog//python/2021/01/22/Python-asyncio-%E5%92%8C-await/#disqus_thread" data-disqus-identifier="/python/2021/01/22/Python-asyncio-%E5%92%8C-await/">0 Comments</a>
      </span>

    </div>
    
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/blog/javascript/2021/01/16/javascript-callbac,-promise,-async,-and-await/">
        [javascript]同步 v.s. 非同步與callback, promise, async, and await
      </a>
    </h1>

    <div class="post-info">
      <!-- <span class="post-date">Posted by Shihs on January 16, 2021</span> -->
      <i class="fas fa-calendar-alt"></i>
      <span class="post-date">January 16, 2021</span>
      <span class="post-categories">
      <!-- <i class="fas fa-tag"></i> -->
      <!-- <i class="far fa-book"></i> -->
      <i class="fas fa-box"></i>
      
      
        <a target="_blank" href="/blog/category/#javascript">javascript</a>
        
      
    </span>


    </div>
    <!-- <p>之前因為在學 node.js 寫過<a href="https://shihs.github.io/blog/javascript/node.js/2020/07/27/node.js-callback/">一篇文章</a>介紹同步非同步以及 callback，但之前沒有實際使用的經驗，有點懵懵懂懂，現在有了一些實際的應用的範例，所以想要再重新整理一次，並加上 promise、async, 與 await。</p>

<hr />

<p>JavaScript Engine 是以單執行緒（單線程/Single Thread）且同步（Synchronous）的方式執行。</p>

<h2 id="同步synchronous">同步（Synchronous）</h2>

<ul>
  <li>指程式必須等待前面的程式執行完才能執行。</li>
</ul>

<h2 id="非同步asynchronous">非同步（Asynchronous）</h2>

<ul>
  <li>指程式不須等待前面的程式執行完就能執行。</li>
</ul>

<p><strong>note</strong></p>
<ul>
  <li>
    <p>執行緒（thread）：執行緒是比程序（process）更小的單元，它是 CPU 的最小執行單元。是作業系統能夠進行運算排程的最小單位。一個程序（process），至少包含一個或多個執行緒。<a href="https://medium.com/@yining1204/javascript-核心篇-學習筆記-chap-15-執行緒與同步-非同步-107802469752">(source)</a></p>
  </li>
  <li>
    <p>單執行緒：單執行的特性是<strong>順序執行</strong>，當遇到比較耗時的任務時，還未執行的任務就會處於等待狀態，一定要等到前面的任務完成了，才會往後執行。<a href="https://medium.com/@yining1204/javascript-核心篇-學習筆記-chap-15-執行緒與同步-非同步-107802469752">(source)</a></p>
  </li>
</ul>

<p>因為 JavaScript 是以單執行緒且同步的方式去執行，它在執行程式碼的時候會按照順序將程式碼片段在堆疊中（stack）執行，而且一次只會執行一個程式碼片段（one thing at a time），只是當碰到非同步（Asynchronous）的任務時，會把它往後放，放到事件佇列(Event Queue)中，等所有的任務完成後才會回來執行。以下面程式碼為例，</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// setTimeout(callbackFunction, timeToDelay)</span>
<span class="nx">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'a'</span><span class="p">);</span>
<span class="p">},</span> <span class="mi">0</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'b'</span><span class="p">);</span>
</code></pre></div></div>

<p>印出來的結果會是</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>b
a
</code></pre></div></div>

<p><code class="highlighter-rouge">setTimeout</code> 是一個非同步的 Web API，JavaScript 執行到這段的時候會將 <code class="highlighter-rouge">setTimeout</code> 放到 Event Queue 中等待，等 stack 中的任務都執行完才回來執行，所以會先印出<code class="highlighter-rouge">b</code>再印<code class="highlighter-rouge">a</code>。</p>

<hr />

<h2 id="callback">Callback</h2>

<p>callback 是 javascript 中很常見的一種使用方式，它讓函式可以當成參數傳進另一個參數中使用，讓我們可以控制程式碼的流程。看以下範例，</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">test</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"This test function is done."</span><span class="p">);</span>
<span class="p">}</span>
<span class="kd">function</span> <span class="nx">main</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"This is main start."</span><span class="p">);</span>
    <span class="nx">callback</span><span class="p">();</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"This is main end."</span><span class="p">);</span>
<span class="p">}</span>
<span class="nx">main</span><span class="p">(</span><span class="nx">test</span><span class="p">);</span>
<span class="c1">// This is main start.</span>
<span class="c1">// This test function is done.</span>
<span class="c1">// This is main end.</span>
</code></pre></div></div>

<p>但其實更多時候 callback 會牽扯到非同步 API 的狀況，像是下面的例子，</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">test</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// 這邊模擬 test 這個 function 去 call 其他 API 要等待的情況</span>
    <span class="c1">// 等了一秒後才會執行 console.log 這個函式</span>
    <span class="nx">setTimeout</span><span class="p">(()</span><span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"This test function is done."</span><span class="p">);</span>
    <span class="p">},</span> <span class="mi">1000</span><span class="p">);</span>
<span class="p">}</span>
<span class="kd">function</span> <span class="nx">main</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"This is main start."</span><span class="p">);</span>
    <span class="nx">callback</span><span class="p">();</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"This is main end."</span><span class="p">);</span>
<span class="p">}</span>
<span class="nx">main</span><span class="p">(</span><span class="nx">test</span><span class="p">);</span>
<span class="c1">// This is main start.</span>
<span class="c1">// This is main end.</span>
<span class="c1">// This test function is done.</span>
</code></pre></div></div>

<p>這次<code class="highlighter-rouge">callback()</code>因為會有等待的情況，所以後面的 “This is main end.” 先被執行完。那假如想要<code class="highlighter-rouge">callback()</code>執行完才執行下一行該怎麼做呢？（譬如說，這個<code class="highlighter-rouge">callback()</code>在做的是使用<code class="highlighter-rouge">XMLHttpRequest()</code>送 request 給某個網頁，而下面的程式碼必須等待網頁的 response 才可以執行下面的程式碼。）這時候只要把，執行 “This is main end.” 這行程式碼也當成 callback() 傳進去就行了。</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">test</span><span class="p">(</span><span class="nx">callback2</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// 這邊模擬 test 這個 function 去 call 其他 API 要等待的情況</span>
    <span class="c1">// 等了一秒後才會執行 console.log 這個函式</span>
    <span class="nx">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"This test function is done."</span><span class="p">);</span>
        <span class="nx">callback2</span><span class="p">();</span>
    <span class="p">},</span> <span class="mi">1000</span><span class="p">);</span>
<span class="p">}</span>
<span class="kd">function</span> <span class="nx">main</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"This is main start."</span><span class="p">);</span>
    <span class="nx">callback</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"This is main end."</span><span class="p">);</span>
    <span class="p">});</span>
<span class="p">}</span>
<span class="nx">main</span><span class="p">(</span><span class="nx">test</span><span class="p">);</span>
<span class="c1">// This is main start.</span>
<span class="c1">// This test function is done.</span>
<span class="c1">// This is main end.</span>
</code></pre></div></div>

<p>所以 callback 可以用來解決非同步的問題，但是當 callback 越來越多，就會形成 <code class="highlighter-rouge">callback hell</code>，就像是下面這樣，</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">api1</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"Done with api1"</span><span class="p">);</span>
        <span class="nx">callback</span><span class="p">();</span>
    <span class="p">},</span> <span class="mi">2000</span><span class="p">);</span>
<span class="p">}</span>
<span class="kd">function</span> <span class="nx">api2</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"Done with api2"</span><span class="p">);</span>
        <span class="nx">callback</span><span class="p">();</span>
    <span class="p">},</span> <span class="mi">1000</span><span class="p">);</span>
<span class="p">}</span>
<span class="kd">function</span> <span class="nx">main</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">api1</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">api2</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="nx">callback</span><span class="p">();</span>
        <span class="p">});</span>
    <span class="p">});</span>
<span class="p">}</span>
<span class="nx">main</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"All function is done."</span><span class="p">);</span>
<span class="p">});</span>
<span class="c1">// "Done with api1"</span>
<span class="c1">// "Done with api2"</span>
<span class="c1">// "All function is done."</span>
</code></pre></div></div>

<p>甚至變成</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">api1</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">api2</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">api3</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="nx">api4</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
                <span class="c1">// bla bla bla</span>
            <span class="p">});</span>
        <span class="p">});</span>
    <span class="p">});</span>
<span class="p">});</span>
</code></pre></div></div>

<hr />

<h2 id="promise">Promise</h2>

<p>Promise 也是一個可以用來處理非同步操作的東西。Promise 通常包括三種狀態：<code class="highlighter-rouge">resolve</code>、<code class="highlighter-rouge">reject</code>和<code class="highlighter-rouge">pending</code>。<code class="highlighter-rouge">resolve</code>代表成功，<code class="highlighter-rouge">rejetc</code>代表失敗，<code class="highlighter-rouge">pending</code>代表還在處理中, 結束狀態未知。<code class="highlighter-rouge">then()</code>方法可以回傳<code class="highlighter-rouge">Promise</code>物件。</p>

<p>例如，現在想要使用<code class="highlighter-rouge">XMLHttpRequest()</code> API傳送 request，我們需要等待 response 後才有後續動作。</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">sleep</span><span class="p">(</span><span class="nx">ms</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">(</span><span class="nx">resolve</span> <span class="o">=&gt;</span> <span class="nx">setTimeout</span><span class="p">(</span><span class="nx">resolve</span><span class="p">,</span> <span class="nx">ms</span><span class="p">));</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">sendHttp</span><span class="p">()</span> <span class="p">{</span>
	<span class="nx">url</span> <span class="o">=</span> <span class="s2">"https://www.google.com/"</span><span class="p">;</span>
	<span class="kd">var</span> <span class="nx">xhr</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>
	<span class="nx">xhr</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="s2">"GET"</span><span class="p">,</span> <span class="nx">url</span><span class="p">);</span>
	<span class="nx">xhr</span><span class="p">.</span><span class="nx">responseType</span> <span class="o">=</span> <span class="s2">"document"</span><span class="p">;</span>
	<span class="nx">xhr</span><span class="p">.</span><span class="nx">send</span><span class="p">();</span>

	<span class="c1">// 如果沒等待 response，status 和 response 會是 0 和 null</span>
	<span class="c1">// console.log(xhr.status);</span>
	<span class="c1">// console.log(xhr.response);</span>

	<span class="nx">sleep</span><span class="p">(</span><span class="mi">2000</span><span class="p">).</span><span class="nx">then</span><span class="p">((</span><span class="nx">result</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
		<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">xhr</span><span class="p">.</span><span class="nx">status</span><span class="p">);</span>
		<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">xhr</span><span class="p">.</span><span class="nx">response</span><span class="p">);</span>
	<span class="p">});</span>
<span class="p">}</span>

<span class="nx">sendHttp</span><span class="p">();</span>
</code></pre></div></div>

<p><code class="highlighter-rouge">then()</code> 其實是可以一直往後加，就是像<code class="highlighter-rouge">callback</code>，想要前面的事情做完，才做下面，形成 Promise Chain，但這樣就又會變成 then hell。所以這時候出現了 async 和 await，讓程式碼看起來更容易閱讀。</p>

<hr />

<h2 id="asyncawait">Async/Await</h2>

<p>async/await 還是會用到 promise，但不使用 then 去啟動。像剛剛上面的例子，可以改寫成下面這樣，</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">sleep</span><span class="p">(</span><span class="nx">ms</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">(</span><span class="nx">resolve</span> <span class="o">=&gt;</span> <span class="nx">setTimeout</span><span class="p">(</span><span class="nx">resolve</span><span class="p">,</span> <span class="nx">ms</span><span class="p">));</span>
<span class="p">}</span>

<span class="k">async</span> <span class="kd">function</span> <span class="nx">sendHttp</span><span class="p">()</span> <span class="p">{</span>
	<span class="nx">url</span> <span class="o">=</span> <span class="s2">"https://www.google.com/"</span><span class="p">;</span>
	<span class="kd">var</span> <span class="nx">xhr</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>
	<span class="nx">xhr</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="s2">"GET"</span><span class="p">,</span> <span class="nx">url</span><span class="p">);</span>
	<span class="nx">xhr</span><span class="p">.</span><span class="nx">responseType</span> <span class="o">=</span> <span class="s2">"document"</span><span class="p">;</span>
	<span class="nx">xhr</span><span class="p">.</span><span class="nx">send</span><span class="p">();</span>

	<span class="kr">await</span> <span class="nx">sleep</span><span class="p">(</span><span class="mi">2000</span><span class="p">);</span>
	<span class="c1">// 如果需要更多 sleep(2000)</span>
	<span class="c1">// await sleep(2000);</span>
		
	<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">xhr</span><span class="p">.</span><span class="nx">status</span><span class="p">);</span>
	<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">xhr</span><span class="p">.</span><span class="nx">response</span><span class="p">);</span>
<span class="p">}</span>

<span class="nx">sendHttp</span><span class="p">();</span>
</code></pre></div></div>

<p>在<code class="highlighter-rouge">sendHttp()</code>這個 function 前加上 async，並在<code class="highlighter-rouge">sleep(2000)</code>前加上 await 就好，整體畫面看起來是不是容易閱讀很多？如果需要更多的<code class="highlighter-rouge">sleep(2000)</code>，只需要多加 await 往下寫就好，整個畫面看起來容易閱讀很多。</p>

<hr />

<p><strong>Reference:</strong>
<br />
<a href="https://medium.com/@hyWang/%E9%9D%9E%E5%90%8C%E6%AD%A5-asynchronous-%E8%88%87%E5%90%8C%E6%AD%A5-synchronous-%E7%9A%84%E5%B7%AE%E7%95%B0-c7f99b9a298a">非同步(Asynchronous)與同步(Synchronous)的差異</a>
<br />
<a href="https://hsiangfeng.github.io/javascript/20191209/1271823341/">世界上誤解最大的語言 JavaScript 之 JS 到底是同步與非同步語言?!</a>
<br />
<a href="https://pjchender.blogspot.com/2017/08/javascript-learn-event-loop-stack-queue.html">[筆記] 理解 JavaScript 中的事件循環、堆疊、佇列和併發模式（Learn event loop, stack, queue, and concurrency mode of JavaScript in depth）</a>
<br />
<a href="https://yu-jack.github.io/2018/07/22/promise/">callback, promise, async/await 使用方式教學以及介紹 Part I</a></p>

 -->
    <div class="post-excerpt"><p>之前因為在學 node.js 寫過<a href="https://shihs.github.io/blog/javascript/node.js/2020/07/27/node.js-callback/">一篇文章</a>介紹同步非同步以及 callback，但之前沒有實際使用的經驗，有點懵懵懂懂，現在有了一些實際的應用的範例，所以想要再重新整理一次，並加上 promise、async, 與 await。</p>

</div>
    

    <div class="bookmark">
      <!-- <i class="far fa-comments"></i> -->
      <i class="fas fa-comments"></i>
      <span>
        


<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
var disqus_config = function () {
        // this.page.url = '/blog//javascript/2021/01/16/javascript-callbac,-promise,-async,-and-await/#disqus_thread';
        this.page.identifier = '/javascript/2021/01/16/javascript-callbac,-promise,-async,-and-await/';
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://mcshihs.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>



        <a href="/blog//javascript/2021/01/16/javascript-callbac,-promise,-async,-and-await/#disqus_thread" data-disqus-identifier="/javascript/2021/01/16/javascript-callbac,-promise,-async,-and-await/">0 Comments</a>
      </span>

    </div>
    
  </div>
  
</div>

<div class="pagination">
  
    <a class="pagination-item older" href="/blog/page2">Older</a>
  
  
    <span class="pagination-item newer">Newer</span>
  
</div>
    </div>
    <script id="dsq-count-scr" src="//mcshihs.disqus.com/count.js" async></script>
  </body>
</html>
