<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>M.C. Shih &middot; BLOG</title>  
  

  <!-- CSS -->
  <link rel="stylesheet" href="/blog/public/css/poole.css">
  <link rel="stylesheet" href="/blog/public/css/syntax.css">
  <link rel="stylesheet" href="/blog/public/css/hyde.css">
  <link rel="stylesheet" href="/blog/public/css/custom.css">
  <link rel="stylesheet" href="/blog/public/css/fontawesome-all.css">
  <link rel="stylesheet" href="/blog/public/css/fontawesome-all.min.css">
  <!-- <link href="https://use.fontawesome.com/releases/v5.0.8/css/all.css" rel="stylesheet"> -->


  <!--<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface"> -->

  <!-- Icons -->
  <link rel="apple-touch-icon" sizes="16x16" href="/blog/public/apple-touch-icon-16-precomposed.png">
  <link rel="apple-touch-icon" sizes="24x24" href="/blog/public/apple-touch-icon-24-precomposed.png">
  <link rel="apple-touch-icon" sizes="32x32" href="/blog/public/apple-touch-icon-32-precomposed.png">
  <link rel="apple-touch-icon" sizes="48x48" href="/blog/public/apple-touch-icon-48-precomposed.png">
  <link rel="apple-touch-icon" sizes="57x57" href="/blog/public/apple-touch-icon-57-precomposed.png">
  <link rel="apple-touch-icon" sizes="64x64" href="/blog/public/apple-touch-icon-64-precomposed.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/blog/public/apple-touch-icon-72-precomposed.png"> 
  <link rel="apple-touch-icon" sizes="114x114" href="/blog/public/apple-touch-icon-114-precomposed.png"> 
  <link rel="apple-touch-icon" sizes="120x120" href="/blog/public/apple-touch-icon-120-precomposed.png"> 
  <link rel="apple-touch-icon" sizes="144x144" href="/blog/public/apple-touch-icon-144-precomposed.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/blog/public/apple-touch-icon-152-precomposed.png">
  <link rel="apple-touch-icon" sizes="512x512" href="/blog/public/apple-touch-icon-512-precomposed.png">
  <link rel="shortcut icon" href="/blog/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/blogblog/atom.xml">
  <!-- 數學符號 -->
  <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>
</head>


  <body>
  	
    <div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <h1>
        <a href="/blog/">
          M.C. Shih
        </a>
        <img src="/blog/img/headshot.png" alt="Author Image" class="headshot">
      </h1>
      <p class="lead">Just for learning.</p>
    </div>

    <nav class="sidebar-nav">
      <a class="sidebar-nav-item" href="/blog/">Blog</a>

      

      
      
        
          
        
      
        
          
            <a class="sidebar-nav-item" href="/blog/about/">About</a>
          
        
      
        
          
            <a class="sidebar-nav-item" href="/blog/archive/">Archives</a>
          
        
      
        
      
        
          
            <a class="sidebar-nav-item" href="/blog/category/">Category</a>
          
        
      
        
          
        
      
        
          
        
      
        
          
            <a class="sidebar-nav-item" href="/blog/search/">Search</a>
          
        
      
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      

    </nav>
    <div class="links">
      <ul>
        <li><a href="https://shihs.github.io" class="homepage" target="_blank"><img src="/blog/img/link%20icon/iconmonstr-home-6-240.png"></a></li>
        <li><a href="https://github.com/shihs" class="github" target="_blank"><img src="/blog/img/link%20icon/iconmonstr-github-3-240.png"></a></li>
        <li><a href="https://www.linkedin.com/in/min-chun-shih-6647779a/" class="linkedin" target="_blank"><img src="/blog/img/link%20icon/iconmonstr-linkedin-3-240.png"></a></li>
        <li><a href="https://www.instagram.com/itakephotos_tw/" class="instagram" target="_blank"><img src="/blog/img/link%20icon/iconmonstr-instagram-8-240.png"></a></li>
        <li><a href="https://www.flickr.com/photos/mcshihs/" class="flickr" target="_blank"><img src="/blog/img/link%20icon/iconmonstr-flickr-3-240.png"></a></li>
      </ul>
    </div>
    

    <p class = "rights">&copy; 2022. All rights reserved.</p>
  </div>
</div>


    <div class="content container">
      <div class="posts" id="begin">
  
  <div class="post">
    <h1 class="post-title">
      <a href="/blog/machine%20learning/2018/12/03/Machine-Learning-Decision-Tree-%E5%92%8C-bagging/">
        [Machine Learning]Decision Tree
      </a>
    </h1>

    <div class="post-info">
      <!-- <span class="post-date">Posted by Shihs on December 3, 2018</span> -->
      <i class="fas fa-calendar-alt"></i>
      <span class="post-date">December 3, 2018</span>
      <span class="post-categories">
      <!-- <i class="fas fa-tag"></i> -->
      <!-- <i class="far fa-book"></i> -->
      <i class="fas fa-box"></i>
      
      
        <a target="_blank" href="/blog/category/#Machine Learning">Machine Learning</a>
        
      
    </span>


    </div>
    <!-- <h2 id="decision-tree">Decision Tree</h2>
<p><img src="http://localhost:4000/blog/img/posts/decision_tree.png" alt="decision_tree.png" height="190px" width="500px" /></p>

<hr />

<p><strong>Decision Tree是什麼？</strong></p>

<p>簡單來說，decision tree 是一個分類模型。</p>

<ul>
  <li>Tree-based methods partition the feature space into a set of rectangles, and then fit a simple model (like a constant) in each one.</li>
</ul>

<p>這是 Pattern Recognition and Machine Learning 裡頭的定義。</p>

<p>根據上圖，想像一下，在右邊的二維座標平面上有一堆散布的點，而 decision tree，就是將這個平面一一分割，每一個框框都是一個分類結果。但我們可以用右邊那樣一層一層的樹枝結構狀來表示右邊難懂的圖。（這裡的例子是二維平面，當變數 \(x_i\) 增加時，這樣的概念可以推廣到多維空間）</p>

<p>每一個分支都像是一個 if-else 問題，如果是就選某一邊，不是就選另外一邊。</p>

<p>上圖左，我們可以看到有兩個變數，\(x_1\), \(x_2\)，第一關是 \(x_1 &gt; \theta_1 \)，如果小於就往左邊分，如果大於就往右邊分，以此類推往下繼續細分，最後給予分類結果。最後共分成 A, B, C, D, E 五個類別，也就是右邊的五個框框。</p>

<p>Decision Tree 又可以分為</p>
<ol>
  <li>
    <p>Regression trees - 最後分類結果為連續變數</p>
  </li>
  <li>
    <p>Classification trees - 最後分類結果為類別變數</p>
  </li>
</ol>

<hr />

<p><strong>名詞</strong></p>

<ul>
  <li>Root node (The Root) - 第一個起始的點</li>
  <li>(Internal) Nodes - 中間的節點。上方會有箭頭指向 node，且 node 也會往下指向其他點。</li>
  <li>Leaves (terminal nodes) - 最後的節點，也就是最後的分類結果。</li>
</ul>

<hr />

<p><strong>如何分類？</strong></p>

<p>假如今天我有一份 data，decision tree 是如何決定要先使用哪一個變數與什麼值作為分割呢？</p>

<p><em>分割的原則是，這樣的分割要能得到最大的資訊增益 (Information gain, IG)</em> (<a href="https://medium.com/@yehjames/資料分析-機器學習-第3-5講-決策樹-decision-tree-以及隨機森林-random-forest-介紹-7079b0ddfbda">[資料分析&amp;機器學習] 第3.5講 : 決策樹(Decision Tree)以及隨機森林</a>)</p>

<p>資訊量根據最後的分類結果可以使用，</p>
<ol>
  <li>Regression trees:
    <ul>
      <li>MSE (mean-squared error)</li>
    </ul>
  </li>
  <li>Classification trees:
    <ul>
      <li>Entropy (Deviance)</li>
      <li>Gini impurity</li>
      <li>Missclassification error</li>
    </ul>
  </li>
</ol>

<p>在 Classification tree 裡，Entropy 和 Gini impurity 是常用的兩種方式，
詳細的公式請參考 <a href="https://en.wikipedia.org/wiki/Decision_tree_learning#Gini_impurity">Wikipedia</a></p>

<p>假如今天碰到兩種 model 算出來的資訊量都ㄧ樣，請選擇比較簡單的那個 model。（分支、leaves node 較少）</p>

<hr />

<p><strong>R 範例</strong>
這裡使用 tree 這個 library 做範例，另外還有像是 rpart 也是做 decision 常用的 package。</p>
<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span><span class="w">
</span><span class="n">data</span><span class="p">(</span><span class="s2">"iris"</span><span class="p">)</span><span class="w">

</span><span class="c1"># 使用 Entropy (Deviance)</span><span class="w">
</span><span class="n">fit</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">tree</span><span class="p">(</span><span class="n">Species</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">Sepal.Length</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Petal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">iris</span><span class="p">,</span><span class="w"> </span><span class="n">split</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"deviance"</span><span class="p">))</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span><span class="w">
</span><span class="n">text</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span><span class="w"> </span><span class="n">pretty</span><span class="o">=</span><span class="m">0</span><span class="p">)</span><span class="w">

</span><span class="n">summary</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span><span class="w">


</span><span class="c1"># 使用 Gini impurity</span><span class="w">
</span><span class="n">fit</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">tree</span><span class="p">(</span><span class="n">Species</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">Sepal.Length</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Petal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">iris</span><span class="p">,</span><span class="w"> </span><span class="n">split</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"gini"</span><span class="p">))</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span><span class="w">
</span><span class="n">text</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span><span class="w"> </span><span class="n">pretty</span><span class="o">=</span><span class="m">0</span><span class="p">)</span><span class="w">

</span><span class="n">summary</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<hr />

<p><strong>優缺點</strong></p>

<ul>
  <li>優點：
    <ol>
      <li>Simple to understand and interpret. 容易理解與解釋</li>
      <li>Able to handle both numerical and categorical data. 可以用在類別與 numerical 資料</li>
    </ol>
  </li>
  <li>缺點
    <ol>
      <li>Low bias and high variance with respect to the training data.
（當 decision tree model 變得太過複雜時，太多 nodes，就會導致 overfitting (<a href="https://en.wikipedia.org/wiki/Bias–variance_tradeoff">bias-variance trade off</a> 的狀況）</li>
    </ol>
  </li>
</ul>

<p>所以為了讓 model 不要 overfitting，我們可以使用 pruning 的方式，砍掉底下的樹枝。</p>

<p>在 R 可以使用，<code class="highlighter-rouge">prune.tree()</code>，並且可以使用 <code class="highlighter-rouge">best</code> 這個參數來決定最後要保留多少 leaves。</p>

<p>使用剛剛最後的 <code class="highlighter-rouge">fit</code>示範</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">prune_fit</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">prune.tree</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span><span class="w"> </span><span class="n">best</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span><span class="p">)</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">prune_fit</span><span class="p">)</span><span class="w">
</span><span class="n">text</span><span class="p">(</span><span class="n">prune_fit</span><span class="p">,</span><span class="w"> </span><span class="n">pretty</span><span class="o">=</span><span class="m">0</span><span class="p">)</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">prune_fit</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>這時候 leaves 由原本的 9，修剪到了剩下 5，但 Misclassification error rate 卻是相同的。修剪過後的 model 較簡單，且 variance 也會比較小，在預測上表現也會較佳。</p>

<hr />

<p>Reference:
<br />
<a href="https://medium.com/@yehjames/資料分析-機器學習-第3-5講-決策樹-decision-tree-以及隨機森林-random-forest-介紹-7079b0ddfbda">[資料分析&amp;機器學習] 第3.5講 : 決策樹(Decision Tree)以及隨機森林</a>
<br />
<a href="https://www.youtube.com/watch?v=7VeUPuFGJHk">StatQuest: Decision Trees</a>
<br />
The Elements of Statistical Learning
<br />
Pattern Recognition and Machine Learning</p>
 -->
    <div class="post-excerpt"><h2 id="decision-tree">Decision Tree</h2>
<p><img src="http://localhost:4000/blog/img/posts/decision_tree.png" alt="decision_tree.png" height="190px" width="500px" /></p>

</div>
    

    <div class="bookmark">
      <!-- <i class="far fa-comments"></i> -->
      <i class="fas fa-comments"></i>
      <span>
        


<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
var disqus_config = function () {
        // this.page.url = '/blog//machine%20learning/2018/12/03/Machine-Learning-Decision-Tree-%E5%92%8C-bagging/#disqus_thread';
        this.page.identifier = '/machine%20learning/2018/12/03/Machine-Learning-Decision-Tree-%E5%92%8C-bagging/';
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://mcshihs.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>



        <a href="/blog//machine%20learning/2018/12/03/Machine-Learning-Decision-Tree-%E5%92%8C-bagging/#disqus_thread" data-disqus-identifier="/machine%20learning/2018/12/03/Machine-Learning-Decision-Tree-%E5%92%8C-bagging/">0 Comments</a>
      </span>

    </div>
    
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/blog/r/2018/11/10/R-%E5%A6%82%E4%BD%95%E5%9C%A8-ggplot2-%E5%9C%96%E5%BD%A2%E4%B8%8A%E5%B8%8C%E8%87%98%E5%AD%97%E6%AF%8D/">
        [R]如何在 ggplot2 圖形上希臘字母？
      </a>
    </h1>

    <div class="post-info">
      <!-- <span class="post-date">Posted by Shihs on November 10, 2018</span> -->
      <i class="fas fa-calendar-alt"></i>
      <span class="post-date">November 10, 2018</span>
      <span class="post-categories">
      <!-- <i class="fas fa-tag"></i> -->
      <!-- <i class="far fa-book"></i> -->
      <i class="fas fa-box"></i>
      
      
        <a target="_blank" href="/blog/category/#R">R</a>
        
      
    </span>


    </div>
    <!-- <p><strong>1. 圖形文字</strong>
<br />
Text Labels: Use parse = T inside geom_text or annotate.</p>

<p><strong>2. 座標軸標籤</strong>
<br />
Axis Labels: Use expression(alpha) to get greek alpha.</p>

<p><strong>3. Legend</strong>
<br />
Legend Labels: Use bquote(alpha == .(value)) in legend label.</p>

<p><strong>4. Fecet圖形</strong>
<br />
Facet 圖形比較特殊，要將 <code class="highlighter-rouge">labeller = label_parsed</code>
<br />
Facet Labels: Use labeller = label_parsed inside facet.</p>

<p><a href="https://stackoverflow.com/questions/5293715/how-to-use-greek-symbols-in-ggplot2">來源</a></p>
 -->
    <div class="post-excerpt"><p><strong>1. 圖形文字</strong>
<br />
Text Labels: Use parse = T inside geom_text or annotate.</p>

</div>
    

    <div class="bookmark">
      <!-- <i class="far fa-comments"></i> -->
      <i class="fas fa-comments"></i>
      <span>
        


<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
var disqus_config = function () {
        // this.page.url = '/blog//r/2018/11/10/R-%E5%A6%82%E4%BD%95%E5%9C%A8-ggplot2-%E5%9C%96%E5%BD%A2%E4%B8%8A%E5%B8%8C%E8%87%98%E5%AD%97%E6%AF%8D/#disqus_thread';
        this.page.identifier = '/r/2018/11/10/R-%E5%A6%82%E4%BD%95%E5%9C%A8-ggplot2-%E5%9C%96%E5%BD%A2%E4%B8%8A%E5%B8%8C%E8%87%98%E5%AD%97%E6%AF%8D/';
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://mcshihs.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>



        <a href="/blog//r/2018/11/10/R-%E5%A6%82%E4%BD%95%E5%9C%A8-ggplot2-%E5%9C%96%E5%BD%A2%E4%B8%8A%E5%B8%8C%E8%87%98%E5%AD%97%E6%AF%8D/#disqus_thread" data-disqus-identifier="/r/2018/11/10/R-%E5%A6%82%E4%BD%95%E5%9C%A8-ggplot2-%E5%9C%96%E5%BD%A2%E4%B8%8A%E5%B8%8C%E8%87%98%E5%AD%97%E6%AF%8D/">0 Comments</a>
      </span>

    </div>
    
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/blog/r/2018/10/20/R-Environment/">
        [R]Environments (1)
      </a>
    </h1>

    <div class="post-info">
      <!-- <span class="post-date">Posted by Shihs on October 20, 2018</span> -->
      <i class="fas fa-calendar-alt"></i>
      <span class="post-date">October 20, 2018</span>
      <span class="post-categories">
      <!-- <i class="fas fa-tag"></i> -->
      <!-- <i class="far fa-book"></i> -->
      <i class="fas fa-box"></i>
      
      
        <a target="_blank" href="/blog/category/#R">R</a>
        
      
    </span>


    </div>
    <!-- <p>這篇要介紹 R 的環境(Environments)。</p>

<p>我個人覺得環境是一個寫程式很重要但一開始會很困惑的東西，之前一直處於似懂非懂的狀態。
<br />
其實如果只是用 R 來跑一些數據分析，其實不理解環境並不會造成什麼太大的問題，但如果能夠懂當然絕對是有利無弊。
<br />
最近有了寫 R package 的經驗後，讓我開始對「環境」比較了解，所以這篇想要將我的理解記錄下來。</p>

<hr />

<h3 id="1-什麼是環境environments">1. 什麼是環境（Environments）？</h3>

<p>當我們每次打開 R studio 這時候便是打開了某個環境，接著我們產生了一些變數，這些變數便是在這個環境底下。</p>

<p>很抽象嗎？
<br />
打開 R studio 時，在右上的框框（或是在某個位置）有個「Environment」，然後可以看到如下圖的「Gloabal Environment」，並且在下面的框框可以看到我們產生的變數（圖中的 x）。
<img src="http://localhost:4000/blog/img/posts/enrionment%20variable.png" alt="enrionment variable.png" height="395px" width="380px" /></p>

<p>這就表示，我們現在在「Gloabal Environment」這個環境底下，且 x 這個變數在「Gloabal Environment」環境中。</p>

<p>當我們把「Gloabal Environment」這個圖往下拉，可以看到像下圖這樣（每個人的可能都不太一樣）
<img src="http://localhost:4000/blog/img/posts/enrionment.png" alt="enrionment.png" height="395px" width="380px" />
依序往下就會是「Gloabal Environment」的 「parent 環境」。</p>

<p>（「parent 環境」是殺毀？！）</p>

<p><strong>環境就像是房間</strong></p>

<p>我覺得可以把「環境」想像是一個房間。
<br />
當妳/你在操作 R ，產生任何變數，做任何動作，都是在這個房間裡面操作（通常一打開 R studio 都會是在 Global 環境）。所以這些變數全部都會被放在這個房間裡。或是想像在一個房間裡縫娃娃這些娃娃做完都會被放在這個房間裡。</p>

<p>那「parent 環境」就會是，妳/你走出這個房間來到客廳，也就是說，這個房間是被包在家裡的，走出家裡，整個家是被包在建築物裡的，然後社區，然後某條路，某個區，某個縣市……就是一個俄羅斯娃娃的感覺。往上一層就會是「parent 環境」、「grand parent 環境」…..以此類推。</p>

<hr />

<h3 id="2-r-是如何在環境裡找變數的">2. R 是如何在環境裡找變數的？</h3>

<p>根據上面的解釋我們知道，每次操作 R 的時候我們都會是在某個環境底下。
<br />
那這和 R 要找變數有什麼關係呢？</p>

<p>在這之前我們先來看我現在有幾間房間呢？</p>
<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">search</span><span class="p">()</span><span class="w">
</span><span class="c1"># [1] ".GlobalEnv"        "tools:rstudio"     "package:stats"     "package:graphics"  "package:grDevices"</span><span class="w">
</span><span class="c1"># [6] "package:utils"     "package:datasets"  "package:methods"   "Autoloads"         "package:base"</span><span class="w">
</span></code></pre></div></div>
<p>這表示，最底下的環境是<code class="highlighter-rouge">.GlobalEnv</code>(Gloabal Environment)，它的 parent 變數是<code class="highlighter-rouge">tools:rstudio</code>，再往上是<code class="highlighter-rouge">package:stats</code>……等等，最後會是<code class="highlighter-rouge">package:base</code>，但其實最上層會是 Empty environment。</p>

<p><strong>在房間裡找東西？</strong></p>

<p>如果今天妳/你人在一個房間裡找東西妳/你會怎麼找？
<br />
一定會先在房間裡搜尋一遍，如果怎麼都找不到，就會去客廳找，再找不到就到這棟建築物找……一直往外找對吧？</p>

<p>所以同樣的，如果今天我們想要找個變數 x，結果 R 發現找不到，那它就會往 parent 環境（search()的順序）找，再找不到就會再往上找，如果一直找到最上層還是沒有，就會跳出像這樣的錯誤。</p>
<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span><span class="w">
</span><span class="c1"># Error: object 'x' not found</span><span class="w">
</span></code></pre></div></div>
<p>找的方式就像是這個圖，<a href="http://adv-r.had.co.nz/Environments.html">source</a>
<img src="http://localhost:4000/blog/img/posts/search%20path.png" alt="search path.png" height="160px" width="500px" /></p>

<p><strong>parent 是誰？</strong></p>

<p>我們可以用<code class="highlighter-rouge">parent.env()</code>來查看上一層環境，</p>
<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">now.env</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">environment</span><span class="p">()</span><span class="w">
</span><span class="n">parent.env</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">parent.env</span><span class="p">(</span><span class="n">now.env</span><span class="p">)</span><span class="w">
</span><span class="n">grandparent.env</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">parent.env</span><span class="p">(</span><span class="n">parent.env</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<hr />

<h3 id="3-可以增加環境嗎">3. 可以增加環境嗎？</h3>
<p>如果仔細看剛剛<code class="highlighter-rouge">search()</code>的結果會發現，那些都是 package 呢！
<br />
其實在每次使用 <code class="highlighter-rouge">library()</code>或是<code class="highlighter-rouge">require()</code> attache 一個 pacakge 後環境就會被改變，這時 Gloabal Environment 的 parent 環境就會變成這個 package。（請自行實驗）</p>

<hr />

<p>（題外話）
<br />
<strong>library() v.s require()</strong>
這兩者到底有什麼差別呢？</p>

<p>基本上兩個的差別只有在於找不到這個 package 時，<code class="highlighter-rouge">library()</code> 會產生 Error 暫停程式，<code class="highlighter-rouge">require()</code>會 FALSE 並吐出 Warning ，然後繼續執行程式。
<br />
所以可以把<code class="highlighter-rouge">require()</code>包在 if 裡，如果沒有這個 package 就安裝，程式也能繼續執行。</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span><span class="w"> </span><span class="n">library</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w">
</span><span class="c1"># Error in library(x) : there is no package called ‘x’</span><span class="w">

</span><span class="n">require</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w">
</span><span class="c1"># Loading required package: x</span><span class="w">
</span><span class="c1"># Warning message:</span><span class="w">
</span><span class="c1"># In library(package, lib.loc = lib.loc, character.only = TRUE, logical.return = TRUE,  :</span><span class="w">
</span><span class="c1">#  there is no package called ‘x’</span><span class="w">
</span></code></pre></div></div>
<p>（題外話結束）</p>

<hr />

<p>也就是說，如果我們今天使用<code class="highlighter-rouge">library()</code>或是<code class="highlighter-rouge">require()</code>就會讓環境改變。
<br />
所以如果今天是要 create package 的話，千萬不要將 <code class="highlighter-rouge">library()</code>和<code class="highlighter-rouge">require()</code>包在任何 function，這樣非常危險，可能會造成 <a href="http://r-pkgs.had.co.nz/namespace.html">Namespace</a> 的混亂。（如果看不懂可以先忽略這段）</p>

<p>那如果今天需要用到這個包，但是又不想讓它加到 search path（parent 環境）裡怎麼辦？</p>

<p>這時候請使用<code class="highlighter-rouge">::</code>。例如，今天想要呼叫 pkg1 裡頭的 fun()，</p>
<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pkg1</span><span class="o">::</span><span class="n">fun</span><span class="p">()</span><span class="w">
</span></code></pre></div></div>
<p><code class="highlighter-rouge">::</code>還有一個很好用的時刻，就是當今天有兩個不同的 package 擁有兩個同樣名稱的 function 時，先載入的 package 順序會被放在後面，所以如果直接呼叫 funciton ，一定會用到後載入的 package 的 function。</p>

<p>如果現在是 pkg1 和 pkg2 都有 fun()，那我們可以這樣用，</p>
<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 呼叫 pkg1 的 fun</span><span class="w">
</span><span class="n">pkg1</span><span class="o">::</span><span class="n">fun</span><span class="p">()</span><span class="w">

</span><span class="c1"># 呼叫 pkg2 的 fun</span><span class="w">
</span><span class="n">pkg2</span><span class="o">::</span><span class="n">fun</span><span class="p">()</span><span class="w">
</span></code></pre></div></div>
<p>這樣就絕對不會出錯了。
不過記得，要使用<code class="highlighter-rouge">::</code>必須要有 install 這個 package 才能使用。</p>

<p><strong>Attaching v.s Loading</strong></p>

<p>library() 和 require() 這兩個 function 的動作都是 <strong>Attaching</strong>，也就是會將這 package 加到 parent 環境 (search path)。
<br />
但 <code class="highlighter-rouge">::</code>則是 <strong>Loading</strong>，也就是說，這個 pacakge 在 loading 後可以在記憶體（memory）中被找到，但不會被加到 parent 環境 (search path) 中。
<a href="http://r-pkgs.had.co.nz/namespace.html#search-path">source</a></p>

<hr />

<p>下次介紹
<br /></p>
<ol>
  <li><code class="highlighter-rouge">new.env()</code>和 function 中的環境</li>
  <li>&lt;- 和 «- 的差別</li>
</ol>

<hr />

<p>Reference:
<br />
<a href="http://adv-r.had.co.nz/Environments.html">Advance R - Environments</a>
<br />
<a href="http://r-pkgs.had.co.nz/namespace.html">R package - Namespace</a>
<br />
<a href="https://www.gl-li.com/2017/09/14/build-a-r-package-for-yourself/">Build a R package for yourself</a>
<br />
<a href="http://tinyheero.github.io/jekyll/update/2015/07/26/making-your-first-R-package.html">Making Your First R Package</a></p>
 -->
    <div class="post-excerpt"><p>這篇要介紹 R 的環境(Environments)。</p>

</div>
    

    <div class="bookmark">
      <!-- <i class="far fa-comments"></i> -->
      <i class="fas fa-comments"></i>
      <span>
        


<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
var disqus_config = function () {
        // this.page.url = '/blog//r/2018/10/20/R-Environment/#disqus_thread';
        this.page.identifier = '/r/2018/10/20/R-Environment/';
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://mcshihs.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>



        <a href="/blog//r/2018/10/20/R-Environment/#disqus_thread" data-disqus-identifier="/r/2018/10/20/R-Environment/">0 Comments</a>
      </span>

    </div>
    
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/blog/r/2018/10/19/R-variable-types/">
        [R]variable types
      </a>
    </h1>

    <div class="post-info">
      <!-- <span class="post-date">Posted by Shihs on October 19, 2018</span> -->
      <i class="fas fa-calendar-alt"></i>
      <span class="post-date">October 19, 2018</span>
      <span class="post-categories">
      <!-- <i class="fas fa-tag"></i> -->
      <!-- <i class="far fa-book"></i> -->
      <i class="fas fa-box"></i>
      
      
        <a target="_blank" href="/blog/category/#R">R</a>
        
      
    </span>


    </div>
    <!-- <p>We know there are several common types in R, such as, vector, list, matrix, and data.frame.
<br />
Here I’m going to see these 4 types more details.</p>

<ol>
  <li>What are the differences between vector, list, matrix, and data.frame?</li>
  <li>What are the outputs of <code class="highlighter-rouge">is.atomic()</code> and <code class="highlighter-rouge">is.vector()</code>?</li>
  <li>What are the outputs of <code class="highlighter-rouge">typeof()</code>?</li>
</ol>

<hr />

<h3 id="1-what-are-the-differences-between-vector-list-matrix-and-dataframe">1. What are the differences between <em>vector</em>, <em>list</em>, <em>matrix</em>, and <em>data.frame</em>?</h3>

<p>We can seperate these four types to two groups from different aspects.</p>

<p><strong>(a) Elements type aspect</strong></p>
<ul>
  <li>Homogeneous data: <em>vector</em>, <em>matrix</em></li>
  <li>Heterogeneous data: <em>list</em>, <em>data.frame</em></li>
</ul>

<p>Which means all elements in <em>vector</em> and <em>matrix</em> have to be the same type (integer, double, or character ect.).
But elements in <em>list</em> and <em>data.frame</em> can be different types.</p>

<p>For example:
<br />
Vector has same type of elements</p>
<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># vector</span><span class="w">
</span><span class="n">v</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="w">
</span><span class="c1">#  v</span><span class="w">
</span><span class="c1"># [1] 1 2 3 4</span><span class="w">

</span><span class="n">v_ch</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"a"</span><span class="p">,</span><span class="w"> </span><span class="s2">"b"</span><span class="p">,</span><span class="w"> </span><span class="s2">"c"</span><span class="p">)</span><span class="w">
</span><span class="c1"># v_ch</span><span class="w">
</span><span class="c1"># [1] "a" "b" "c"</span><span class="w">
</span></code></pre></div></div>
<p>What if we give a vector different type of elements?</p>
<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">v</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="s2">"2"</span><span class="p">)</span><span class="w">
</span><span class="c1"># v</span><span class="w">
</span><span class="c1">#[1] "1" "2"</span><span class="w">
</span></code></pre></div></div>
<p>As you can see, R forces 1 to be character.</p>

<p>But what is the priority? Why not “2” become numeric?</p>

<p>Because <strong>the hierarchy for coercion</strong> is:
<br /></p>
<ul>
  <li><strong>logical &lt; integer &lt; numeric &lt; character</strong></li>
</ul>

<p>So this is why numeric would be force to character.</p>

<p><a href="https://campus.datacamp.com/courses/introduction-to-r-for-finance/vectors-and-matrices?ex=3">reference</a></p>

<p><strong>(b) Dimension aspect</strong></p>
<ul>
  <li>1 Dimension: <em>vector</em>, <em>list</em></li>
  <li>2 Dimensions: <em>matrix</em>, <em>data.frame</em></li>
</ul>

<hr />

<h3 id="2-what-are-the-outputs-of-isatomic-and-isvector">2. What are the outputs of <code class="highlighter-rouge">is.atomic()</code> and <code class="highlighter-rouge">is.vector()</code>?</h3>

<p>Let’s see the outputs of these four types.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">v</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="w"> </span><span class="c1"># vector</span><span class="w">
</span><span class="n">l</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">)</span><span class="w"> </span><span class="c1"># list</span><span class="w">
</span><span class="n">mat</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">matrix</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">ncol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="c1"># matrix</span><span class="w">
</span><span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.frame</span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="c1"># data.frame</span><span class="w">
</span></code></pre></div></div>

<p><strong>(a) is.atomic()</strong></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># &gt; is.atomic(v)</span><span class="w">
</span><span class="c1"># [1] TRUE</span><span class="w">
</span><span class="c1"># &gt; is.atomic(l)</span><span class="w">
</span><span class="c1"># [1] FALSE</span><span class="w">
</span><span class="c1"># &gt; is.atomic(mat)</span><span class="w">
</span><span class="c1"># [1] TRUE</span><span class="w">
</span><span class="c1"># &gt; is.atomic(df)</span><span class="w">
</span><span class="c1"># [1] FALSE</span><span class="w">
</span></code></pre></div></div>
<p>As you can see the results, <code class="highlighter-rouge">is.atomic()</code> gives boolean values.
<br />
And the output is to see if the object is <em>Homogeneous data</em> or <em>Hetergeneous data</em>.
<br />
Hence, <em>vector</em> and <em>matrix</em> get TRUE, <em>list</em> and <em>data.frame</em> get FALSE.</p>

<p><strong>(b) is.vector()</strong></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># is.vector(v)</span><span class="w">
</span><span class="c1"># [1] TRUE</span><span class="w">
</span><span class="c1"># is.vector(l)</span><span class="w">
</span><span class="c1"># [1] TRUE</span><span class="w">
</span><span class="c1"># is.vector(mat)</span><span class="w">
</span><span class="c1"># [1] FALSE</span><span class="w">
</span><span class="c1"># is.vector(df)</span><span class="w">
</span><span class="c1"># [1] FALSE</span><span class="w">
</span></code></pre></div></div>
<p>In contrast with is.atomic(), <code class="highlighter-rouge">is.vector()</code> checks from Dimension aspect.</p>

<hr />

<h3 id="3-what-are-the-outputs-of-typeof">3. What are the outputs of <code class="highlighter-rouge">typeof()</code></h3>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># vector</span><span class="w">
</span><span class="n">v</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="w">  </span><span class="c1"># all elements are numeric</span><span class="w">
</span><span class="n">v_ch</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"a"</span><span class="p">,</span><span class="w"> </span><span class="s2">"b"</span><span class="p">,</span><span class="w"> </span><span class="s2">"c"</span><span class="p">)</span><span class="w">  </span><span class="c1"># all elements are characters</span><span class="w">
</span><span class="c1"># list</span><span class="w">
</span><span class="n">l</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">)</span><span class="w">  </span><span class="c1"># all elements are numeric</span><span class="w">
</span><span class="n">l_ch</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"a"</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"b"</span><span class="p">)</span><span class="w"> </span><span class="c1"># all elements are characters</span><span class="w">
</span><span class="c1"># matrix</span><span class="w">
</span><span class="n">mat</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">matrix</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">ncol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w">  </span><span class="c1"># all elements are numeric</span><span class="w">
</span><span class="n">mat_ch</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">matrix</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="s2">"a"</span><span class="p">,</span><span class="w"> </span><span class="s2">"b"</span><span class="p">),</span><span class="w"> </span><span class="n">ncol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w">  </span><span class="c1"># all elements are characters</span><span class="w">
</span><span class="c1"># data.frame</span><span class="w">
</span><span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.frame</span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>
<p>Let’s see the results,</p>
<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># ---vector-------------</span><span class="w">
</span><span class="c1"># &gt; typeof(v)</span><span class="w">
</span><span class="c1"># [1] "integer"</span><span class="w">
</span><span class="c1"># &gt; typeof(v_ch)</span><span class="w">
</span><span class="c1"># [1] "character"</span><span class="w">
</span><span class="c1"># ---list-------------</span><span class="w">
</span><span class="c1"># &gt; typeof(l)</span><span class="w">
</span><span class="c1"># [1] "list"</span><span class="w">
</span><span class="c1"># &gt; typeof(l_ch)</span><span class="w">
</span><span class="c1"># [1] "list"</span><span class="w">
</span><span class="c1"># ---matrix-------------</span><span class="w">
</span><span class="c1"># &gt; typeof(mat)</span><span class="w">
</span><span class="c1"># [1] "integer"</span><span class="w">
</span><span class="c1"># &gt; typeof(mat_ch)</span><span class="w">
</span><span class="c1"># [1] "character"</span><span class="w">
</span><span class="c1"># ---data.frame-------------</span><span class="w">
</span><span class="c1"># &gt; typeof(df)</span><span class="w">
</span><span class="c1"># [1] "list"</span><span class="w">
</span></code></pre></div></div>

<p>From the result of ouputs, we can see it checks if the object is <em>Homogeneous data</em> or not.
<br />
If it is <em>Homogeneous data</em> then <code class="highlighter-rouge">typeof()</code> will show the type of elements.
<br />
But if the object is <em>Hetergeneous data</em>, it will give only <em>list</em> as output result.</p>

<hr />

<p>More detail about Data Structure can be found <a href="http://adv-r.had.co.nz/Data-structures.html">here</a></p>

<p>Reference:
<br />
<a href="https://zhuanlan.zhihu.com/p/25551827">R深入|数据类型</a></p>

 -->
    <div class="post-excerpt"><p>We know there are several common types in R, such as, vector, list, matrix, and data.frame.
<br />
Here I’m going to see these 4 types more details.</p>

</div>
    

    <div class="bookmark">
      <!-- <i class="far fa-comments"></i> -->
      <i class="fas fa-comments"></i>
      <span>
        


<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
var disqus_config = function () {
        // this.page.url = '/blog//r/2018/10/19/R-variable-types/#disqus_thread';
        this.page.identifier = '/r/2018/10/19/R-variable-types/';
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://mcshihs.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>



        <a href="/blog//r/2018/10/19/R-variable-types/#disqus_thread" data-disqus-identifier="/r/2018/10/19/R-variable-types/">0 Comments</a>
      </span>

    </div>
    
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/blog/r/2018/10/04/R-RStudtio%E7%B7%A8%E7%A2%BC%E5%95%8F%E9%A1%8C/">
        [R]RStudtio編碼問題
      </a>
    </h1>

    <div class="post-info">
      <!-- <span class="post-date">Posted by Shihs on October 4, 2018</span> -->
      <i class="fas fa-calendar-alt"></i>
      <span class="post-date">October 4, 2018</span>
      <span class="post-categories">
      <!-- <i class="fas fa-tag"></i> -->
      <!-- <i class="far fa-book"></i> -->
      <i class="fas fa-box"></i>
      
      
        <a target="_blank" href="/blog/category/#R">R</a>
        
      
    </span>


    </div>
    <!-- <p>解決編碼問題可以說最惱人的事了……<br />
在使用中文或是其他歐語系語言時經常碰到編碼問題，這篇我根據我自己的一些經驗整理了一些在使用 RStudio 時解決編碼問題的辦法。</p>

<hr />

<p>根據我的經驗，我覺得編碼問題可以分成三種，</p>
<ol>
  <li>R 程式碼編碼問題</li>
  <li>檔案編碼問題</li>
  <li>系統編碼問題</li>
</ol>

<h3 id="1-r-程式碼編碼問題">1. R 程式碼編碼問題</h3>
<p>當你打開一份 R Script 時，發現 script 中的中文都是亂碼時，這時應該是這份 script 檔案的編碼與你電腦的 RScript 預設的不同。</p>

<p>這時選擇 File -&gt; Reopen with Encoding… 更改編碼(UTF-8、BIG5、ASCII試試)，問題應該就可以解決了。</p>

<p>或是可以直接更改預設的讀檔編碼，到 Tools -&gt; Global Options… -&gt; (左邊選單) Code -&gt; Saving 更改 Default text encoding。</p>

<h3 id="2-檔案編碼問題">2. 檔案編碼問題</h3>
<p>當你讀進一份檔案，可能碰到以下幾種狀況<br /></p>

<p>a. 讀檔時出現編碼錯誤<br />
解決方法： <br />
(1)讀檔時設定 fileEncoding：讀檔時提供檔案本身編碼資訊，<a href="https://shihs.github.io/blog/r/2018/01/17/R-read.csv出現編碼錯誤訊息/">參考</a><br /></p>

<p>(2)更改檔案編碼：先更改檔案本身的編碼，再使用 RStudio 讀取檔案。<br />
   如果是 Windows，我個人推薦直接使用記事本更改最方便。另存新檔直接存成需要的編碼。<br /></p>

<p>(3)更改預設讀檔編碼：如第一個提到的 R 程式碼編碼問題的解決方案，直接更改預設的編碼，設定成 UTF-8 應該是最好的。<br /></p>

<p>b. 順利讀進檔案，但無法正確顯示<br />
讀檔時，使用 encoding 參數來決定要顯示什麼語言</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">read.csv</span><span class="p">(</span><span class="s2">"filename.csv"</span><span class="p">,</span><span class="w"> </span><span class="n">encoding</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"latin1"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<h3 id="3-系統編碼問題">3. 系統編碼問題</h3>
<p>順利讀進檔案，已更改輸入時的編碼，但顯示仍舊錯誤。<br />
這問題是在讀一份含有瑞典文的檔案時碰到的，已經更改過檔案的編碼，但開啟後仍無法正確顯示瑞典文。</p>

<p>可以檢查一下系統本身的編碼是不是 UTF-8</p>
<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sessionInfo</span><span class="p">()</span><span class="w"> </span><span class="c1"># 裡的 local</span><span class="w">
</span><span class="c1"># 或是</span><span class="w">
</span><span class="n">Sys.getlocale</span><span class="p">()</span><span class="w">

</span><span class="c1"># MAC 會長得大概像這樣</span><span class="w">
</span><span class="c1"># "en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8"</span><span class="w">
</span></code></pre></div></div>
<p>如果不是，更改系統的語系，以下更改為 UTF-8</p>
<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># for windows</span><span class="w">
</span><span class="n">Sys.setlocale</span><span class="p">(</span><span class="n">category</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"LC_ALL"</span><span class="p">,</span><span class="w"> </span><span class="n">locale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"UTF-8"</span><span class="p">)</span><span class="w">

</span><span class="c1"># for mac</span><span class="w">
</span><span class="n">Sys.setlocale</span><span class="p">(</span><span class="n">category</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"LC_ALL"</span><span class="p">,</span><span class="w"> </span><span class="n">locale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"en_US.UTF-8"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<hr />

<p>另外，要查看 vector 的編碼可以使用</p>
<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># x is a vector</span><span class="w">
</span><span class="n">Encoding</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>我個人認為，解決編碼問題最重要的就是要先知道編碼出錯的問題在哪。<br />
是檔案本身編碼問題，還是系統的問題，那是要修改檔案還是要修改系統？<br /></p>

 -->
    <div class="post-excerpt"><p>解決編碼問題可以說最惱人的事了……<br />
在使用中文或是其他歐語系語言時經常碰到編碼問題，這篇我根據我自己的一些經驗整理了一些在使用 RStudio 時解決編碼問題的辦法。</p>

</div>
    

    <div class="bookmark">
      <!-- <i class="far fa-comments"></i> -->
      <i class="fas fa-comments"></i>
      <span>
        


<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
var disqus_config = function () {
        // this.page.url = '/blog//r/2018/10/04/R-RStudtio%E7%B7%A8%E7%A2%BC%E5%95%8F%E9%A1%8C/#disqus_thread';
        this.page.identifier = '/r/2018/10/04/R-RStudtio%E7%B7%A8%E7%A2%BC%E5%95%8F%E9%A1%8C/';
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://mcshihs.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>



        <a href="/blog//r/2018/10/04/R-RStudtio%E7%B7%A8%E7%A2%BC%E5%95%8F%E9%A1%8C/#disqus_thread" data-disqus-identifier="/r/2018/10/04/R-RStudtio%E7%B7%A8%E7%A2%BC%E5%95%8F%E9%A1%8C/">0 Comments</a>
      </span>

    </div>
    
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/blog/algorithm/2018/09/28/Algorithm-Hamiltonian-path-and-Travelling-Salesman-Problem(TSP)/">
        [Algorithm]Hamiltonian path and Travelling Salesman Problem(TSP)
      </a>
    </h1>

    <div class="post-info">
      <!-- <span class="post-date">Posted by Shihs on September 28, 2018</span> -->
      <i class="fas fa-calendar-alt"></i>
      <span class="post-date">September 28, 2018</span>
      <span class="post-categories">
      <!-- <i class="fas fa-tag"></i> -->
      <!-- <i class="far fa-book"></i> -->
      <i class="fas fa-box"></i>
      
      
        <a target="_blank" href="/blog/category/#Algorithm">Algorithm</a>
        
      
    </span>


    </div>
    <!-- <p>以下簡單地整理網路上查到的 Hamiltonian path 與 Travelling Salesman Problem 介紹。</p>

<hr />

<h3 id="hamiltonian-path">Hamiltonian path</h3>

<p><strong>What is Hamiltonian path?</strong><br />
<a href="https://en.wikipedia.org/wiki/Hamiltonian_path">Hamiltonian path</a> is a path that visit every node only once. It can be an undirected or directed graph. Also it</p>

<p><strong>Hamiltonian cycle</strong><br />
If a Hamiltonian path is a cycle then we call it A Hamiltonian cycle (or Hamiltonian circuit).</p>

<p><strong>Hamiltonian path problem</strong><br />
Determining whether such paths and cycles exist in graphs is the Hamiltonian path problem, which is NP-complete</p>

<hr />

<h3 id="travelling-salesman-problem">Travelling Salesman Problem</h3>

<p><strong>What is Travelling Salesman Problem(TSP)?</strong><br />
There is a man traveling. He departures from a city and he wants to visit every cities(nods) with the shortest distance. In the end, he will go back to the origin city, and he can only stop in each city once.</p>

<p>Which means, TSP is looking for the shortest distance of <em>Hamiltonian cycle</em>.</p>

<hr />

<p>reference:<br />
<a href="http://www.csie.ntnu.edu.tw/~u91029/Circuit.html">演算法筆記</a><br />
<a href="https://en.wikipedia.org/wiki/Travelling_salesman_problem">Wikipedia - TSP</a><br />
<a href="https://en.wikipedia.org/wiki/Hamiltonian_path">Wikipedia - Hamiltonian path</a><br /></p>
 -->
    <div class="post-excerpt"><p>以下簡單地整理網路上查到的 Hamiltonian path 與 Travelling Salesman Problem 介紹。</p>

</div>
    

    <div class="bookmark">
      <!-- <i class="far fa-comments"></i> -->
      <i class="fas fa-comments"></i>
      <span>
        


<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
var disqus_config = function () {
        // this.page.url = '/blog//algorithm/2018/09/28/Algorithm-Hamiltonian-path-and-Travelling-Salesman-Problem(TSP)/#disqus_thread';
        this.page.identifier = '/algorithm/2018/09/28/Algorithm-Hamiltonian-path-and-Travelling-Salesman-Problem(TSP)/';
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://mcshihs.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>



        <a href="/blog//algorithm/2018/09/28/Algorithm-Hamiltonian-path-and-Travelling-Salesman-Problem(TSP)/#disqus_thread" data-disqus-identifier="/algorithm/2018/09/28/Algorithm-Hamiltonian-path-and-Travelling-Salesman-Problem(TSP)/">0 Comments</a>
      </span>

    </div>
    
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/blog/r/2018/09/27/R-scale-%E8%88%87-dist-function/">
        [R]scale 與 dist function
      </a>
    </h1>

    <div class="post-info">
      <!-- <span class="post-date">Posted by Shihs on September 27, 2018</span> -->
      <i class="fas fa-calendar-alt"></i>
      <span class="post-date">September 27, 2018</span>
      <span class="post-categories">
      <!-- <i class="fas fa-tag"></i> -->
      <!-- <i class="far fa-book"></i> -->
      <i class="fas fa-box"></i>
      
      
        <a target="_blank" href="/blog/category/#R">R</a>
        
      
    </span>


    </div>
    <!-- <p>這篇文章會介紹 R 中的 scale 與 dist 兩個 function。</p>

<p>在做資料分析前會需要先標準化</p>

<hr />

<h3 id="scale">scale</h3>
<p>scale 的主要作用在標準化數據，共有三個 arguments，</p>
<ul>
  <li>x: 必須要是 matrix，以「行」為每組數據計算</li>
  <li>center: TRUE or FALSE。中心化，TRUE 會減去數據的平均值</li>
  <li>scale: TRUE or FALSE。 TRUE 會將數據中的每個值除以數據的標準差</li>
</ul>

<p>預設 center 和 scale 都是 TRUE，也就是算出來的值是 <a href="https://zh.wikipedia.org/wiki/標準分數">z-score</a>。</p>

<blockquote>

  <p>\(z = \frac{x - \mu}{\sigma}, \sigma \neq 0\)</p>
</blockquote>

<p>其中：<br />
\(x\)：數據<br />
\(\mu\)：平均值<br />
\(\sigma\)：標準差</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">matrix</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="n">nrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span><span class="p">)</span><span class="w">

</span><span class="n">scale</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<hr />

<h3 id="dist">dist</h3>
<p>dist 是在算數據間的距離，主要的 arguments有</p>
<ul>
  <li>x: 可以是 matrix, data.frame ，但必須要是 numeric。</li>
  <li>methods: 共有六種計算距離的方法，”euclidean”, “maximum”, “manhattan”, “canberra”, “binary” 和 “minkowski”，預設是使用 euclidean 距離。</li>
</ul>

<p>以「列」為數據，兩兩計算，</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">matrix</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="n">nrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span><span class="p">)</span><span class="w">

</span><span class="n">dist</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

 -->
    <div class="post-excerpt"><p>這篇文章會介紹 R 中的 scale 與 dist 兩個 function。</p>

</div>
    

    <div class="bookmark">
      <!-- <i class="far fa-comments"></i> -->
      <i class="fas fa-comments"></i>
      <span>
        


<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
var disqus_config = function () {
        // this.page.url = '/blog//r/2018/09/27/R-scale-%E8%88%87-dist-function/#disqus_thread';
        this.page.identifier = '/r/2018/09/27/R-scale-%E8%88%87-dist-function/';
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://mcshihs.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>



        <a href="/blog//r/2018/09/27/R-scale-%E8%88%87-dist-function/#disqus_thread" data-disqus-identifier="/r/2018/09/27/R-scale-%E8%88%87-dist-function/">0 Comments</a>
      </span>

    </div>
    
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/blog/r/2018/09/14/R-%E5%A6%82%E4%BD%95%E5%9C%A8R-Package%E5%8A%A0%E4%B8%8Acode-coverage-(codecov)/">
        [R]如何在R Package加上code coverage (codecov)?
      </a>
    </h1>

    <div class="post-info">
      <!-- <span class="post-date">Posted by Shihs on September 14, 2018</span> -->
      <i class="fas fa-calendar-alt"></i>
      <span class="post-date">September 14, 2018</span>
      <span class="post-categories">
      <!-- <i class="fas fa-tag"></i> -->
      <!-- <i class="far fa-book"></i> -->
      <i class="fas fa-box"></i>
      
      
        <a target="_blank" href="/blog/category/#R">R</a>
        
      
    </span>


    </div>
    <!-- <p><a href="https://zh.wikipedia.org/wiki/代碼覆蓋率">code coverage</a>(代碼覆蓋率)?</p>

<p>這篇是根據<a href="https://walczak.org/2017/06/how-to-add-code-coverage-codecov-to-your-r-package/">這篇</a>的步驟操作。
如果要找 package 內容物該有的東西可以參考我完成的一個 <a href="https://github.com/shihs/LiUAdRLab3">R package</a>。</p>

<p>以下會將步驟一一列下。</p>

<hr />

<h3 id="1-完成-r-package-與建立-test-測試">1. 完成 R package 與建立 test 測試</h3>
<p>建立 <a href="http://r-pkgs.had.co.nz">R package</a> 可以參考大神的書，test 則可以參考這本書的 <a href="http://r-pkgs.had.co.nz/tests.html">testing 章節</a>。</p>

<p>基本上使用，</p>
<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">devtools</span><span class="o">::</span><span class="n">use_testthat</span><span class="p">()</span><span class="w">
</span></code></pre></div></div>
<p>就會自己建立一個 <a href="https://github.com/shihs/LiUAdRLab3/tree/master/tests">tests 資料夾</a>，再把要測試的程式碼加進下一層的 <a href="https://github.com/shihs/LiUAdRLab3/tree/master/tests/testthat">testthat 資料夾</a>內。</p>

<p>最後進行測試，</p>
<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">devtools</span><span class="o">::</span><span class="n">test</span><span class="p">()</span><span class="w">
</span></code></pre></div></div>

<hr />

<h3 id="2-建立所有-code-coverage-需要的檔案與內容">2. 建立所有 code coverage 需要的檔案與內容</h3>

<p>先跑一下程式碼，</p>
<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">devtools</span><span class="o">::</span><span class="n">use_coverage</span><span class="p">()</span><span class="w">
</span></code></pre></div></div>

<p>跑完後會出現以下的步驟提示，</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>* Creating `codecov.yml` from template.
* Adding `codecov.yml` to `.Rbuildignore`.
* Add to `README.md`: 
[![Coverage Status](https://img.shields.io/codecov/c/github/shihs/LiUAdRLab3/master.svg)](https://codecov.io/github/shihs/LiUAdRLab3?branch=master)
* Add to `.travis.yml`:
after_success:
  - Rscript -e 'covr::codecov()'
</code></pre></div></div>

<p>基本上就一步一步照著做就對了，前面兩件事程式已經幫你處理好了，<br />
從第三步開始就行。</p>

<hr />

<h3 id="3-將-github-與-codecov-連結">3. 將 Github 與 codecov 連結</h3>

<p>使用 Github 帳號登入 <a href="https://codecov.io">codecov.io </a>。</p>

<p>連結你要使用 codecov 的 reposity，
會出現像這樣的<a href="https://walczak.org/wp-content/uploads/2017/06/token.png">畫面</a>得到一組 token，
將 token 複製，在 R 中跑以下程式碼，</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">install.packages</span><span class="p">(</span><span class="s2">"covr"</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">covr</span><span class="p">)</span><span class="w">
</span><span class="n">codecov</span><span class="p">(</span><span class="n">token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"YOUR_TOKEN_GOES_HERE"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>大功告成！</p>

<p>這時候會看到你剛剛貼上的 coverage 圖案出現 code coverage 的結果。</p>

<hr />

<p>如果想要先在 R studio 上看測試結果可以使用，</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="w"> </span><span class="p">(</span><span class="n">covr</span><span class="p">)</span><span class="w">
</span><span class="n">report</span><span class="p">()</span><span class="w">
</span></code></pre></div></div>

<p>viewer 視窗就會顯示測試結果了。</p>

 -->
    <div class="post-excerpt"><p><a href="https://zh.wikipedia.org/wiki/代碼覆蓋率">code coverage</a>(代碼覆蓋率)?</p>

</div>
    

    <div class="bookmark">
      <!-- <i class="far fa-comments"></i> -->
      <i class="fas fa-comments"></i>
      <span>
        


<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
var disqus_config = function () {
        // this.page.url = '/blog//r/2018/09/14/R-%E5%A6%82%E4%BD%95%E5%9C%A8R-Package%E5%8A%A0%E4%B8%8Acode-coverage-(codecov)/#disqus_thread';
        this.page.identifier = '/r/2018/09/14/R-%E5%A6%82%E4%BD%95%E5%9C%A8R-Package%E5%8A%A0%E4%B8%8Acode-coverage-(codecov)/';
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://mcshihs.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>



        <a href="/blog//r/2018/09/14/R-%E5%A6%82%E4%BD%95%E5%9C%A8R-Package%E5%8A%A0%E4%B8%8Acode-coverage-(codecov)/#disqus_thread" data-disqus-identifier="/r/2018/09/14/R-%E5%A6%82%E4%BD%95%E5%9C%A8R-Package%E5%8A%A0%E4%B8%8Acode-coverage-(codecov)/">0 Comments</a>
      </span>

    </div>
    
  </div>
  
</div>

<div class="pagination">
  
    <a class="pagination-item older" href="/blog/page7">Older</a>
  
  
    
      <a class="pagination-item newer" href="/blog/page5">Newer</a>
    
  
</div>
    </div>
    <script id="dsq-count-scr" src="//mcshihs.disqus.com/count.js" async></script>
  </body>
</html>
